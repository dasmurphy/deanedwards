<?xml version="1.0"?>
<bindings id="wf2-input"
          xmlns="http://www.mozilla.org/xbl"
          xmlns:html="http://www.w3.org/1999/xhtml"
          xmlns:xul="http://www.mozilla.org/keymaster/gatekeeper/there.is.only.xul"
          xmlns:xbl="http://www.mozilla.org/xbl">

<binding id="input-text">
 <implementation>
  <constructor>
   if (this.hasAttribute("autofocus")) {
  	this.focus();
   }
   //this.style.display = "inline-block";
  </constructor>
 </implementation>
 <handlers>
  <handler event="invalid">
   var hint = document.getAnonymousElementByAttribute(this, "anonid", "hint");
   hint.firstChild.textContent = this.validationMessage;
   hint.showPopup();
  </handler>
 </handlers>
 <content>
  <xul:popup anonid="hint">
   <xul:description anonid="text"/>
  </xul:popup>
 </content>
</binding>

<binding id="-input-text-extended" extends="#input-text">
 <handlers>
  <handler event="input">
   var extended = document.getAnonymousElementByAttribute(this, "anonid", "extended");
   this.value = extended.value;
  </handler>

  <handler event="change">
   var extended = document.getAnonymousElementByAttribute(this, "anonid", "extended");
   if (event.originalTarget == extended) {
     this.value = extended.value;
   }
  </handler>
 </handlers>
</binding>

<binding id="input-list" extends="#-input-text-extended">
 <handlers>
  <handler event="ValueChange">
   var extended = document.getAnonymousElementByAttribute(this, "anonid", "extended");
   if (event.originalTarget == extended) {
     this.value = extended.value;
   }
  </handler>
 </handlers>
 <content>
  <html:span html:style="display:none"><children /></html:span>
  <xul:menulist anonid="extended" editable="true"
   xbl:inherits="onfocus,onblur,disabled,value,readonly,tabindex,accesskey">
   <xul:menupopup>
    <!-- TO DO: fill list -->
    <xul:menuitem label="Elephants" value="Elephants"/>
    <xul:menuitem label="Kangaroos" value="Kangaroos"/>
    <xul:menuitem label="Bats" value="Bats"/>
   </xul:menupopup>
  </xul:menulist>
  <xul:popup anonid="hint">
   <xul:description anonid="text"/>
  </xul:popup>
 </content>
</binding>

<binding id="input-number" extends="#-input-text-extended">
 <content>
  <xul:textbox anonid="extended" type="number"
   xbl:inherits="onfocus,onblur,min,max,increment=step,value,disabled,readonly,tabindex,accesskey"/>
  <xul:popup anonid="hint">
   <xul:description anonid="text"/>
  </xul:popup>
 </content>
</binding>

<binding id="input-range" extends="#input-number">
 <implementation>
  <constructor>
   setTimeout(function(element) {
     var extended = document.getAnonymousElementByAttribute(element, "anonid", "extended");
     extended.orient = (this.offsetHeight > this.offsetWidth) ? "vertical" : "horizontal";
    }, 0, this);
  </constructor>
 </implementation>
 <content>
  <xul:scale anonid="extended" orient="horizontal"
   xbl:inherits="onfocus,onblur,min,max,increment=step,value,disabled,readonly,tabindex,accesskey"/>
  <xul:popup anonid="hint">
   <xul:description anonid="text"/>
  </xul:popup>
 </content>
</binding>

<binding id="input-range-readonly" extends="#input-range">
 <content>
  <xul:progressmeter anonid="extended" orient="horizontal"
   xbl:inherits="onfocus,onblur,min,max,increment=step,value,disabled,readonly,tabindex,accesskey"/>
  <xul:popup anonid="hint">
   <xul:description anonid="text"/>
  </xul:popup>
 </content>
</binding>

<binding id="input-datetime" extends="#input-text">
 <implementation>
  <constructor>
   setTimeout(function(element) {
     var extended = document.getAnonymousElementByAttribute(element, "anonid", "extended");
     extended.dateValue = new Date(element.valueAsNumber);
    }, 0, this);
  </constructor>
 </implementation>
 <handlers>
  <handler event="input">
   var extended = document.getAnonymousElementByAttribute(this, "anonid", "extended");
   this.valueAsNumber = Number(extended.dateValue);
  </handler>

  <handler event="change">
   var extended = document.getAnonymousElementByAttribute(this, "anonid", "extended");
   if (event.originalTarget == extended) {
     this.valueAsNumber = Number(extended.dateValue);
   }
  </handler>
 </handlers>
 <content>
  <html:span style="display:none"><children /></html:span>
  <xul:datetimepicker anonid="extended"
   xbl:inherits="onfocus,onblur,disabled,readonly,tabindex,accesskey"/>
  <xul:popup anonid="hint">
   <xul:description anonid="text"/>
  </xul:popup>
 </content>
</binding>

<binding id="input-date" extends="#input-datetime">
 <content>
  <xul:datepicker anonid="extended" type="popup"
   xbl:inherits="onfocus,onblur,disabled,readonly,tabindex,accesskey"/>
  <xul:popup anonid="hint">
   <xul:description anonid="text"/>
  </xul:popup>
 </content>
</binding>

<binding id="input-time" extends="#input-datetime">
 <content>
  <html:span style="display:none"><children /></html:span>
  <xul:timepicker anonid="extended" type="number"
   xbl:inherits="onfocus,onblur,increment=step,disabled,readonly,tabindex,accesskey"/>
  <xul:popup anonid="hint">
   <xul:description anonid="text"/>
  </xul:popup>
 </content>
</binding>

<binding id="input-week" extends="#input-date">
 <content>
  <html:span style="display:none"><children /></html:span>
  <xul:datepicker anonid="extended" type="popup"
   xbl:inherits="onfocus,onblur,disabled,readonly,tabindex,accesskey"/>
  <xul:popup anonid="hint">
   <xul:description anonid="text"/>
  </xul:popup>
 </content>
</binding>

<binding id="input-month" extends="#input-date">
 <content>
  <html:span style="display:none"><children /></html:span>
  <xul:datepicker anonid="extended"
   xbl:inherits="onfocus,onblur,disabled,readonly,tabindex,accesskey"/>
  <xul:popup anonid="hint">
   <xul:description anonid="text"/>
  </xul:popup>
 </content>
</binding>

</bindings>
