var base2={};new function(_){var Base=function(){};Base.prototype={extend:function(source){if(arguments.length>1){var ancestor=this[source];var value=arguments[1];if(typeof value=="function"&&ancestor&&/\bbase\b/.test(value)){var method=value;value=function(){var previous=this.base;this.base=ancestor;var returnValue=method.apply(this,arguments);this.base=previous;return returnValue};value.method=method;value.ancestor=ancestor}this[source]=value}else if(source){var extend=Base.prototype.extend;if(Base._prototyping){var key,i=0,members=["constructor","toString","valueOf"];while(key=members[i++])if(source[key]!=Object.prototype[key]){extend.call(this,key,source[key])}}else if(typeof this!="function"){extend=this.extend||extend}for(key in source)if(!Object.prototype[key]){extend.call(this,key,source[key])}}return this},base:Base};Base.extend=function(_instance,_static){var extend=Base.prototype.extend;Base._prototyping=true;var proto=new this;extend.call(proto,_instance);delete Base._prototyping;var constructor=proto.constructor;var klass=proto.constructor=function(){if(!Base._prototyping){if(this._constructing||this.constructor==klass){this._constructing=true;constructor.apply(this,arguments);delete this._constructing}else{var object=arguments[0];if(object!=null){(object.extend||extend).call(object,proto)}return object}}};for(var i in Base)klass[i]=this[i];klass.ancestor=this;klass.base=Base.base;klass.prototype=proto;klass.toString=this.toString;extend.call(klass,_static);if(typeof klass.init=="function")klass.init();return klass};Base=Base.extend({constructor:function(){this.extend(arguments[0])}},{ancestor:Object,base:Base,implement:function(_interface){if(typeof _interface=="function"){_interface(this.prototype)}else{this.prototype.extend(_interface)}return this}});var Legacy=typeof $Legacy=="undefined"?{}:$Legacy;var K=function(k){return k};var assert=function(condition,message,Err){if(!condition){throw new(Err||Error)(message||"Assertion failed.");}};var assertType=function(object,type,message){if(type){var condition=typeof type=="function"?instanceOf(object,type):typeof object==type;assert(condition,message||"Invalid type.",TypeError)}};var copy=function(object){var fn=new Function;fn.prototype=object;return new fn};var format=function(string){var args=arguments;return String(string).replace(/%([1-9])/g,function(match,index){return index<args.length?args[index]:match})};var $instanceOf=Legacy.instanceOf||new Function("o,k","return o instanceof k");var instanceOf=function(object,klass){assertType(klass,"function","Invalid 'instanceOf' operand.");if($instanceOf(object,klass))return true;if(object!=null)switch(klass){case Object:return true;case Number:case Boolean:case Function:case String:return typeof object==typeof klass.prototype.valueOf();case Array:return!!(object.join&&object.splice&&!arguments.callee(object,Function));case Date:return!!object.getTimezoneOffset;case RegExp:return String(object.constructor.prototype)==String(new RegExp)}return false};var match=function(string,expression){return String(string).match(expression)||[]};var RESCAPE=/([\/()[\]{}|*+-.,^$?\\])/g;var rescape=function(string){return String(string).replace(RESCAPE,"\\$1")};var $slice=Array.prototype.slice;var slice=function(object){return $slice.apply(object,$slice.call(arguments,1))};var TRIM=/^\s+|\s+$/g;var trim=function(string){return String(string).replace(TRIM,"")};var base=function(object,args){return object.base.apply(object,args)};var extend=function(object){assert(object!=Object.prototype,"Object.prototype is verboten!");return Base.prototype.extend.apply(object,slice(arguments,1))};var $ID=1;var assignID=function(object){if(!object.base2ID)object.base2ID="b2_"+$ID++;return object.base2ID};if(typeof StopIteration=="undefined"){StopIteration=new Error("StopIteration")}var forEach=function(object,block,context){if(object==null)return;if(typeof object=="function"){var fn=Function}else if(typeof object.forEach=="function"&&object.forEach!=arguments.callee){object.forEach(block,context);return}else if(typeof object.length=="number"){forEach.Array(object,block,context);return}forEach.Function(fn||Object,object,block,context)};forEach.Array=function(array,block,context){var i,length=array.length;if(typeof array=="string"){for(i=0;i<length;i++){block.call(context,array.charAt(i),i,array)}}else{for(i=0;i<length;i++){block.call(context,array[i],i,array)}}};forEach.Function=Legacy.forEach||function(fn,object,block,context){for(var key in object){if(fn.prototype[key]===undefined){block.call(context,object[key],key,object)}}};Base.forEach=function(object,block,context){forEach.Function(this,object,block,context)};Function.prototype.prototype={};if("".replace(/^/,String)){extend(String.prototype,"replace",function(expression,replacement){if(typeof replacement=="function"){if(instanceOf(expression,RegExp)){var regexp=expression;var global=regexp.global;if(global==null)global=/(g|gi)$/.test(regexp);if(global)regexp=new RegExp(regexp.source)}else{regexp=new RegExp(rescape(expression))}var match,string=this,result="";while(string&&(match=regexp.exec(string))){result+=string.slice(0,match.index)+replacement.apply(this,match);string=string.slice(match.index+match[0].length);if(!global)break}return result+string}else{return base(this,arguments)}})}var Abstract=Base.extend({constructor:function(){throw new TypeError("Class cannot be instantiated.");}});var Module=Abstract.extend(null,{extend:function(_interface,_static){var module=this.base();forEach(this,function(property,name){if(!Module[name]&&name!="init"){extend(module,name,property)}});module.implement(_interface);extend(module,_static);if(typeof module.init=="function")module.init();return module},implement:function(_interface){var module=this;if(typeof _interface=="function"){module.base(_interface);forEach(_interface,function(property,name){if(!Module[name]&&name!="init"){extend(module,name,property)}})}else{Base.forEach(extend({},_interface),function(property,name){if(typeof property=="function"){property=function(){base;return module[name].apply(module,[this].concat(slice(arguments)))}}if(!Module[name])extend(this,name,property)},module.prototype);extend(module,_interface)}return module}});var Enumerable=Module.extend({every:function(object,test,context){var result=true;try{this.forEach(object,function(value,key){result=test.call(context,value,key,object);if(!result)throw StopIteration;})}catch(error){if(error!=StopIteration)throw error;}return!!result},filter:function(object,test,context){return this.reduce(object,function(result,value,key){if(test.call(context,value,key,object)){result[result.length]=value}return result},new Array2)},invoke:function(object,method){var args=slice(arguments,2);return this.map(object,(typeof method=="function")?function(item){if(item!=null)return method.apply(item,args)}:function(item){if(item!=null)return item[method].apply(item,args)})},map:function(object,block,context){var result=new Array2;this.forEach(object,function(value,key){result[result.length]=block.call(context,value,key,object)});return result},pluck:function(object,key){return this.map(object,function(item){if(item!=null)return item[key]})},reduce:function(object,block,result,context){this.forEach(object,function(value,key){result=block.call(context,result,value,key,object)});return result},some:function(object,test,context){return!this.every(object,function(value,key){return!test.call(context,value,key,object)})}},{forEach:forEach});var IArray=Module.extend({combine:function(keys,values){if(!values)values=keys;return this.reduce(keys,function(object,key,index){object[key]=values[index];return object},{})},copy:function(array){return this.concat(array)},contains:function(array,item){return this.indexOf(array,item)!=-1},forEach:forEach.Array,indexOf:function(array,item,fromIndex){var length=array.length;if(fromIndex==null){fromIndex=0}else if(fromIndex<0){fromIndex=Math.max(0,length+fromIndex)}for(var i=fromIndex;i<length;i++){if(array[i]===item)return i}return-1},insertAt:function(array,item,index){this.splice(array,index,0,item);return item},insertBefore:function(array,item,before){var index=this.indexOf(array,before);if(index==-1)this.push(array,item);else this.splice(array,index,0,item);return item},lastIndexOf:function(array,item,fromIndex){var length=array.length;if(fromIndex==null){fromIndex=length-1}else if(from<0){fromIndex=Math.max(0,length+fromIndex)}for(var i=fromIndex;i>=0;i--){if(array[i]===item)return i}return-1},remove:function(array,item){var index=this.indexOf(array,item);if(index!=-1)this.removeAt(array,index);return item},removeAt:function(array,index){var item=array[index];this.splice(array,index,1);return item}});IArray.prototype.forEach=function(block,context){forEach.Array(this,block,context)};IArray.implement(Enumerable);forEach("concat,join,pop,push,reverse,shift,slice,sort,splice,unshift".split(","),function(name){IArray[name]=function(array){return Array.prototype[name].apply(array,slice(arguments,1))}});var Array2=function(){return IArray(this.constructor==IArray?Array.apply(null,arguments):arguments[0])};Array2.prototype=IArray.prototype;forEach(IArray,function(method,name,proto){if(Array[name]){IArray[name]=Array[name];delete IArray.prototype[name]}Array2[name]=IArray[name]});var HASH="#"+Number(new Date);var KEYS=HASH+"keys";var VALUES=HASH+"values";var Hash=Base.extend({constructor:function(values){this[KEYS]=new Array2;this[VALUES]={};this.merge(values)},copy:function(){var copy=new this.constructor(this);Base.forEach(this,function(property,name){if(typeof property!="function"&&name.charAt(0)!="#"){copy[name]=property}});return copy},exists:Legacy.exists||new Function("k",format("return('%1'+k)in this['%2']",HASH,VALUES)),fetch:function(key){return this[VALUES][HASH+key]},forEach:function(block,context){forEach(this[KEYS],function(key){block.call(context,this.fetch(key),key,this)},this)},keys:function(index,length){var keys=this[KEYS]||new Array2;switch(arguments.length){case 0:return keys.copy();case 1:return keys[index];default:return keys.slice(index,length)}},merge:function(values){forEach(arguments,function(values){forEach(values,function(value,key){this.store(key,value)},this)},this);return this},remove:function(key){var value=this.fetch(key);this[KEYS].remove(String(key));delete this[VALUES][HASH+key];return value},store:function(key,value){if(arguments.length==1)value=key;if(!this.exists(key)){this[KEYS].push(String(key))}this[VALUES][HASH+key]=value;return value},toString:function(){return String(this[KEYS])},union:function(values){return this.merge.apply(this.copy(),arguments)},values:function(index,length){var values=this.map(K);switch(arguments.length){case 0:return values;case 1:return values[index];default:return values.slice(index,length)}}});Hash.implement(Enumerable);var Collection=Hash.extend({add:function(key,item){assert(!this.exists(key),"Duplicate key.");return this.store.apply(this,arguments)},count:function(){return this[KEYS].length},indexOf:function(key){return this[KEYS].indexOf(String(key))},insertAt:function(index,key,item){assert(!this.exists(key),"Duplicate key.");this[KEYS].insertAt(index,String(key));return this.store.apply(this,slice(arguments,1))},item:function(index){return this.fetch(this[KEYS][index])},removeAt:function(index){return this.remove(this[KEYS][index])},reverse:function(){this[KEYS].reverse();return this},sort:function(compare){if(compare){var self=this;this[KEYS].sort(function(key1,key2){return compare(self.fetch(key1),self.fetch(key2),key1,key2)})}else this[KEYS].sort();return this},store:function(key,item){if(arguments.length==1)item=key;item=this.constructor.create.apply(this.constructor,arguments);return this.base(key,item)},storeAt:function(index,item){assert(index<this.count(),"Index out of bounds.");arguments[0]=this[KEYS][index];return this.store.apply(this,arguments)}},{Item:null,create:function(key,item){if(this.Item&&!instanceOf(item,this.Item)){item=new this.Item(key,item)}return item},extend:function(_instance,_static){var klass=this.base(_instance);klass.create=this.create;extend(klass,_static);if(!klass.Item){klass.Item=this.Item}else if(typeof klass.Item!="function"){klass.Item=(this.Item||Base).extend(klass.Item)}if(typeof klass.init=="function")klass.init();return klass}});var RegGrp=Collection.extend({constructor:function(values,flags){this.base(values);if(typeof flags=="string"){this.global=/g/.test(flags);this.ignoreCase=/i/.test(flags)}},global:true,ignoreCase:false,exec:function(string,replacement){if(arguments.length==1){var keys=this[KEYS];var values=this[VALUES];replacement=function(match){if(!match)return"";var offset=1,i=0;while(match=values[HASH+keys[i++]]){if(arguments[offset]){var replacement=match.replacement;switch(typeof replacement){case"function":return replacement.apply(null,slice(arguments,offset));case"number":return arguments[offset+replacement];default:return replacement}}else offset+=match.length+1}}}var flags=(this.global?"g":"")+(this.ignoreCase?"i":"");return String(string).replace(new RegExp(this,flags),replacement)},test:function(string){return this.exec(string)!=string},toString:function(){var length=0;return"("+this.map(function(item){var expression=String(item).replace(/\\(\d+)/g,function($,index){return"\\"+(1+Number(index)+length)});length+=item.length+1;return expression}).join(")|(")+")"}},{IGNORE:"$0",init:function(){forEach("add,exists,fetch,remove,store".split(","),function(name){extend(this,name,function(expression){if(instanceOf(expression,RegExp)){expression=expression.source}return base(this,arguments)})},this.prototype)}});RegGrp.Item=Base.extend({constructor:function(expression,replacement){var ESCAPE=/\\./g;var STRING=/(['"])\1\+(.*)\+\1\1$/;expression=instanceOf(expression,RegExp)?expression.source:String(expression);if(typeof replacement=="number")replacement=String(replacement);else if(replacement==null)replacement="";this.length=match(expression.replace(ESCAPE,"").replace(/\[[^\]]+\]/g,""),/\(/g).length;if(typeof replacement=="string"&&/\$(\d+)/.test(replacement)){if(/^\$\d+$/.test(replacement)){replacement=parseInt(replacement.slice(1))}else{var i=this.length+1;var Q=/'/.test(replacement.replace(ESCAPE,""))?'"':"'";replacement=replacement.replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/\$(\d+)/g,Q+"+(arguments[$1]||"+Q+Q+")+"+Q);replacement=new Function("return "+Q+replacement.replace(STRING,"$1")+Q)}}this.replacement=replacement;this.toString=function(){return expression||""}},length:0,replacement:""});var Namespace=Base.extend({constructor:function(_private,_public){this.extend(_public);this.toString=function(){return format("[base2.%1]",this.name)};if(typeof this.init=="function")this.init();if(this.name!="base2"){this.namespace=format("var %1=base2.%1;",this.name)}var namespace="var base="+base+";";var imports=("base2,lang,"+this.imports).split(",");_private.imports=Enumerable.reduce(imports,function(namespace,name){if(base2[name])namespace+=base2[name].namespace;return namespace},namespace);var namespace=format("base2.%1=%1;",this.name);var exports=this.exports.split(",");_private.exports=Enumerable.reduce(exports,function(namespace,name){if(name){this.namespace+=format("var %2=%1.%2;",this.name,name);namespace+=format("if(!%1.%2)%1.%2=%2;base2.%2=%1.%2;",this.name,name)}return namespace},namespace,this);if(this.name!="base2"){base2.namespace+=format("var %1=base2.%1;",this.name)}},exports:"",imports:"",namespace:"",name:""});base2=new Namespace(this,{name:"base2",version:"0.8 (alpha)",exports:"Base,Abstract,Module,Enumerable,Array2,Hash,Collection,RegGrp,Namespace"});base2.toString=function(){return"[base2]"};eval(this.exports);var lang=new Namespace(this,{name:"lang",version:base2.version,exports:"K,assert,assertType,assignID,copy,instanceOf,extend,format,forEach,match,rescape,slice,trim",init:function(){this.extend=extend;forEach(Enumerable.prototype,function(method,name){if(!Module[name]){this[name]=function(){return Enumerable[name].apply(Enumerable,arguments)};this.exports+=","+name}},this)}});eval(this.exports);base2.namespace+=lang.namespace};new function(_){var element=document.createElement("span");var jscript/*@cc_on=@_jscript_version@*/;var BOM={userAgent:"",init:function(){var MSIE/*@cc_on=true@*/;var userAgent=navigator.userAgent;if(!MSIE)userAgent=userAgent.replace(/MSIE\s[\d.]+/,"");userAgent=userAgent.replace(/([a-z])[\s\/](\d)/gi,"$1$2");this.userAgent=navigator.platform+" "+userAgent},detect:function(test){var r=false;var not=test.charAt(0)=="!";test=test.replace(/^\!?(if\s*|platform\s+)?/,"").replace(/^(["']?)([^\(].*)(\1)$/,"/($2)/i.test(BOM.userAgent)");try{eval("r=!!"+test)}catch(error){}return Boolean(not^r)}};base2.extend(BOM,{name:"BOM",version:"0.9",exports:"detect,Window"});BOM=new base2.Namespace(this,BOM);eval(this.imports);var _extend=Base.prototype.extend;Base.prototype.extend=function(source,value){if(typeof source=="string"&&source.charAt(0)=="@"){return BOM.detect(source.slice(1))?_extend.call(this,value):this}return _extend.apply(this,arguments)};if(BOM.detect("MSIE.+win")){var $closures={};BOM.$bind=function(method,element){if(!element||element.nodeType!=1){return method}var $element=element.uniqueID;var $method=assignID(method);$closures[$method]=method;if(!$closures[$element])$closures[$element]={};var closure=$closures[$element][$method];if(closure)return closure;element=null;method=null;var bound=function(){var element=document.all[$element];if(element)return $closures[$method].apply(element,arguments)};bound.cloneID=$method;$closures[$element][$method]=bound;return bound};attachEvent("onunload",function(){$closures=null})}var Window=Module.extend(null,{verify:function(window){return(window&&window.Infinity)?window:null},"@MSIE":{verify:function(window){return(window==self)?self:this.base()}}});eval(this.exports)};new function(_){var DOM=new base2.Namespace(this,{name:"DOM",version:"0.9 (alpha)",imports:"BOM",exports:"Node,Document,Element,Traversal,AbstractView,Event,EventTarget,DocumentEvent,Selector,DocumentSelector,ElementSelector,StaticNodeList,ViewCSS,HTMLDocument,HTMLElement"});eval(this.imports);var Interface=Module.extend(null,{createDelegate:function(name){this[name]=function(object){var m=(object.base&&object.base==object[name].ancestor)?"base":name;return object[m].apply(object,slice(arguments,1))}},extend:function(_interface,_static){var module=this.base();forEach(_interface,function(source,name){if(typeof source=="function"&&!module[name]){module.createDelegate(name)}else if(name.charAt(0)=="@"){forEach(source,arguments.callee)}});module.implement(_interface);extend(module,_static);if(typeof module.init=="function")module.init();return module},"@!(element.addEventListener.apply)":{createDelegate:function(name){this[name]=function(object){var m=(object.base&&object.base==object[name].ancestor)?"base":name;switch(arguments.length){case 1:return object[m]();case 2:return object[m](arguments[1]);case 3:return object[m](arguments[1],arguments[2]);case 4:return object[m](arguments[1],arguments[2],arguments[3])}var args=[],i=arguments.length;while(i-->1)args[i-1]="arguments["+i+"]";eval("var returnValue=object[m]("+args+")");return returnValue}}}});var Binding=Interface.extend(null,{extend:function(_interface,_static){var bind=this.bind;if(_static){bind=_static.bind||bind;delete _static.bind}var binding=this.base(_interface,_static);extend(binding,"bind",bind);return binding}});Binding.bind=function(object){return this(object)};var Traversal=Module.extend({getDefaultView:function(node){return this.getDocument(node).defaultView},getNextElementSibling:function(node){while(node&&(node=node.nextSibling)&&!this.isElement(node))continue;return node},getNodeIndex:function(node){var index=0;while(node&&(node=node.previousSibling))index++;return index},getOwnerDocument:function(node){return node.ownerDocument},getPreviousElementSibling:function(node){while(node&&(node=node.previousSibling)&&!this.isElement(node))continue;return node},getTextContent:function(node){return node[Traversal.$TEXT]},isEmpty:function(node){node=node.firstChild;while(node){if(node.nodeType==3||this.isElement(node))return false;node=node.nextSibling}return true},setTextContent:function(node,text){return node[Traversal.$TEXT]=text},"@MSIE":{getDefaultView:function(node){return this.getDocument(node).parentWindow},"@MSIE5":{getOwnerDocument:function(node){return node.ownerDocument||node.document}}}},{$TEXT:"textContent",contains:function(node,target){return this.isDocument(node)?node==this.getOwnerDocument(target):node!=target&&node.contains(target)},getDocument:function(node){return this.isDocument(node)?node:this.getOwnerDocument(node)},isDocument:function(node){return Boolean(node&&node.documentElement)},isElement:function(node){return Boolean(node&&node.attributes)},"@!(element.contains)":{contains:function(node,target){while(target&&(target=target.parentNode)&&node!=target)continue;return!!target}},"@MSIE":{$TEXT:"innerText"},"@MSIE5":{isElement:function(node){return this.base(node)&&node.tagName!="!"}}});var Node=Binding.extend({"@!(element.compareDocumentPosition)":{compareDocumentPosition:function(node,other){if(Traversal.contains(node,other)){return 4|16}else if(Traversal.contains(other,node)){return 2|8}var nodeIndex=this.$getSourceIndex(node);var otherIndex=this.$getSourceIndex(other);if(nodeIndex<otherIndex){return 4}else if(nodeIndex>otherIndex){return 2}return 0}}},{$getSourceIndex:function(node){var key=0;while(node){key=Traversal.getNodeIndex(node)+"."+key;node=node.parentNode}return key},"@(element.sourceIndex)":{$getSourceIndex:function(node){return node.sourceIndex}}});var Document=Node.extend(null,{bind:function(document){this.base(document);AbstractView.bind(document.defaultView);return document}});Document.createDelegate("createElement");var Element=Node.extend({"@MSIE[67]":{getAttribute:function(element,name){if(element.className===undefined||name=="href"||name=="src"){return this.base(element,name,2)}var attribute=element.getAttributeNode(name);return attribute&&attribute.specified?attribute.nodeValue:null}},"@MSIE5.+win":{getAttribute:function(element,name){if(element.className===undefined||name=="href"||name=="src"){return this.base(element,name,2)}var attribute=element.attributes[this.$htmlAttributes[name.toLowerCase()]||name];return attribute?attribute.specified?attribute.nodeValue:null:this.base(element,name)}}},{$htmlAttributes:"",init:function(){var keys=this.$htmlAttributes.toLowerCase().split(",");var values=this.$htmlAttributes.split(",");this.$htmlAttributes=Array2.combine(keys,values)},"@MSIE5.+win":{$htmlAttributes:"colSpan,rowSpan,vAlign,dateTime,accessKey,tabIndex,encType,maxLength,readOnly,longDesc"}});Element.createDelegate("setAttribute");extend(DOM,{bind:function(node){switch(node.nodeType){case 1:return Element.bind(node);case 9:return Document.bind(node);default:return Node.bind(node)}return node}});var _bound={};var _bind=function(node){if(node){var uid=assignID(node);if(!_bound[uid]){DOM.bind(node);_bound[uid]=true}}return node};var AbstractView=Binding.extend();var Event=Binding.extend({"@!(document.createEvent)":{initEvent:function(event,type,bubbles,cancelable){event.type=type;event.bubbles=bubbles;event.cancelable=cancelable},"@MSIE":{initEvent:function(event){base(this,arguments);event.cancelBubble=!event.bubbles},preventDefault:function(event){if(event.cancelable!==false){event.returnValue=false}},stopPropagation:function(event){event.cancelBubble=true}}}},{"@MSIE":{"Mac":{bind:function(event){return this.base(extend({preventDefault:function(){if(this.cancelable!==false){this.returnValue=false}}},event))}},"Windows":{bind:function(event){this.base(event);event.target=event.srcElement;return event}}}});var EventTarget=Interface.extend({"@!(element.addEventListener)":{addEventListener:function(target,type,listener){var $target=assignID(target);var $listener=listener.cloneID||assignID(listener);var events=this.$all[$target];if(!events)events=this.$all[$target]={};var listeners=events[type];var current=target["on"+type];if(!listeners){listeners=events[type]={};if(current)listeners[0]=current}listeners[$listener]=listener;if(current!==undefined){target["on"+type]=this.$dispatch}},dispatchEvent:function(target,event){this.$dispatch.call(target,event)},removeEventListener:function(target,type,listener){var events=this.$all[target.base2ID];if(events&&events[type]){delete events[type][listener.base2ID]}},"@MSIE.+win":{addEventListener:function(target,type,listener){this.base(target,type,this._bind(listener,target))},dispatchEvent:function(target,event){event.target=target;try{target.fireEvent(event.type,event)}catch(error){this.base(target,event)}}}}},{_bind:function(listener,context){var bound=function(){return listener.apply(context,arguments)};bound.cloneID=assignID(listener);return bound},"@!(element.addEventListener)":{$all:{},$dispatch:function(event){var returnValue=true;var events=EventTarget.$all[this.base2ID];if(events){event=Event.bind(event);var listeners=events[event.type];for(var i in listeners){returnValue=listeners[i].call(this,event);if(event.returnValue===false)returnValue=false;if(returnValue===false)break}}return returnValue},"@MSIE":{$dispatch:function(event){if(!event){var window=Window.verify(this)||Traversal.getDefaultView(this);event=window.event}return this.base(event)},"Windows":{_bind:function(listener,context){return BOM.$bind(listener,context)}}}}});extend(EventTarget,{addEventListener:function(target,type,listener,context){if(context)listener=this._bind(listener,context);this.base(target,type,listener,false)},dispatchEvent:function(target,event){if(typeof event=="string"){var type=event;var document=Traversal.getDocument(target);event=DocumentEvent.createEvent(document,"Events");Event.initEvent(event,type,false,false)}this.base(target,event)}});var DocumentEvent=Interface.extend({"@!(document.createEvent)":{createEvent:function(document){return Event.bind({})},"@(document.createEventObject)":{createEvent:function(document){return Event.bind(document.createEventObject())}}},"@KHTML":{createEvent:function(document,type){return this.base(document,type=="Events"?"UIEvents":type)}}});var DOMContentLoaded=new Base({fired:false,fire:function(){if(!DOMContentLoaded.fired){DOMContentLoaded.fired=true;setTimeout("base2.EventTarget.dispatchEvent(document,'DOMContentLoaded')",0)}},init:function(){EventTarget.addEventListener(document,"DOMContentLoaded",function(){DOMContentLoaded.fired=true});EventTarget.addEventListener(window,"load",DOMContentLoaded.fire)},"@(addEventListener)":{init:function(){this.base();addEventListener("load",DOMContentLoaded.fire,false)}},"@(attachEvent)":{init:function(){this.base();attachEvent("onload",DOMContentLoaded.fire)}},"@MSIE.+win":{init:function(){this.base();document.write("<script id=__ready defer src=//:><\/script>");document.all.__ready.onreadystatechange=function(){if(this.readyState=="complete"){this.removeNode();DOMContentLoaded.fire()}}}},"@KHTML":{init:function(){this.base();var timer=setInterval(function(){if(/loaded|complete/.test(document.readyState)){clearInterval(timer);DOMContentLoaded.fire()}},100)}}});DOMContentLoaded.init();var ViewCSS=Interface.extend({"@!(getComputedStyle)":{getComputedStyle:function(view,element){return element.currentStyle}}},{toCamelCase:function(string){return String(string).replace(/\-([a-z])/g,function(match,chr){return chr.toUpperCase()})}});extend(Document,{"@!(document.defaultView)":{bind:function(document){this.base(document);document.defaultView=Traversal.getDefaultView(document);return document}}});var NodeSelector=Interface.extend({"@!(element.matchSingle)":{matchAll:function(node,selector){return new Selector(selector).exec(node)},matchSingle:function(node,selector){return new Selector(selector).exec(node,1)}}});extend(NodeSelector.prototype,{matchAll:function(selector){return extend(this.base(selector),"item",function(index){return _bind(this.base(index))})},matchSingle:function(selector){return _bind(this.base(selector))}});var DocumentSelector=NodeSelector.extend();var ElementSelector=NodeSelector.extend({"@!(element.matchesSelector)":{matchesSelector:function(element,selector){return new Selector(selector).test(element)}}});var StaticNodeList=Base.extend({constructor:function(nodes){nodes=nodes||[];this.length=nodes.length;this.item=function(index){return nodes[index]}},length:0,forEach:function(block,context){var length=this.length;for(var i=0;i<length;i++){block.call(context,this.item(i),i,this)}},item:function(index){},"@(XPathResult)":{constructor:function(nodes){if(nodes&&nodes.snapshotItem){this.length=nodes.snapshotLength;this.item=function(index){return nodes.snapshotItem(index)}}else this.base(nodes)}}});StaticNodeList.implement(Enumerable);var Selector=Base.extend({constructor:function(selector){this.toString=function(){return trim(selector)}},exec:function(context,single){var result=this.$evaluate(context||document,single);return single?result:new StaticNodeList(result)},test:function(element){element.setAttribute("b2_test",true);var selector=new Selector(this+"[b2_test]");var result=selector.exec(Traversal.getOwnerDocument(element),1);element.removeAttribute("b2_test");return result==element},$evaluate:function(context,single){return Selector.parse(this)(context,single)}});var Parser=RegGrp.extend({constructor:function(){base(this,arguments);this.cache={};this.sorter=new RegGrp;this.sorter.add(/:not\([^)]*\)/,RegGrp.IGNORE);this.sorter.add(/([ >](\*|[\w-]+))([^: >+~]*)(:\w+-child(\([^)]+\))?)([^: >+~]*)/,"$1$3$6$4")},cache:null,ignoreCase:true,escape:function(selector){var strings=this._strings=[];return this.optimise(this.format(String(selector).replace(Parser.ESCAPE,function(string){strings.push(string.slice(1,-1));return"%"+strings.length})))},format:function(selector){return selector.replace(Parser.WHITESPACE,"$1").replace(Parser.IMPLIED_SPACE,"$1 $2").replace(Parser.IMPLIED_ASTERISK,"$1*$2")},optimise:function(selector){return this.sorter.exec(selector.replace(Parser.WILD_CARD,">* "))},parse:function(selector){return this.cache[selector]||(this.cache[selector]=this.unescape(this.exec(this.escape(selector))))},unescape:function(selector){return format(selector,this._strings)}},{ESCAPE:/(["'])[^\1]*\1/g,IMPLIED_ASTERISK:/([\s>+~,]|[^(]\+|^)([#.:@])/g,IMPLIED_SPACE:/(^|,)([^\s>+~])/g,WHITESPACE:/\s*([\s>+~(),]|^|$)\s*/g,WILD_CARD:/\s\*\s/g,_nthChild:function(match,args,position,last,not,and,mod,equals){last=/last/i.test(match)?last+"+1-":"";if(!isNaN(args))args="0n+"+args;else if(args=="even")args="2n";else if(args=="odd")args="2n+1";args=args.split(/n\+?/);var a=(args[0]=="")?1:(args[0]=="-")?-1:parseInt(args[0]);var b=parseInt(args[1])||0;var not=a<0;if(not){a=-a;if(a==1)b++}var query=format(a==0?"%3%7"+(last+b):"(%4%3-%2)%6%1%70%5%4%3>=%2",a,b,position,last,and,mod,equals);if(not)query=not+"("+query+")";return query}});Selector.operators={"=":"%1=='%2'","~=":/(^| )%1( |$)/,"|=":/^%1(-|$)/,"^=":/^%1/,"$=":/%1$/,"*=":/%1/};Selector.operators[""]="%1!=null";Selector.pseudoClasses={"checked":"e%1.checked","contains":"Traversal.getTextContent(e%1).indexOf('%2')!=-1","disabled":"e%1.disabled","empty":"Traversal.isEmpty(e%1)","enabled":"e%1.disabled===false","first-child":"!Traversal.getPreviousElementSibling(e%1)","last-child":"!Traversal.getNextElementSibling(e%1)","only-child":"!Traversal.getPreviousElementSibling(e%1)&&!Traversal.getNextElementSibling(e%1)","root":"e%1==Traversal.getDocument(e%1).documentElement"};new function(_){var MSIE=BOM.detect("MSIE");var MSIE5=BOM.detect("MSIE5");var INDEXED=BOM.detect("(element.sourceIndex)");var VAR="var p%2=0,i%2,e%2,n%2=e%1.";var ID=INDEXED?"e%1.sourceIndex":"assignID(e%1)";var TEST="var g="+ID+";if(!p[g]){p[g]=1;";var STORE="r[r.length]=e%1;if(s)return e%1;";var FN="fn=function(e0,s){indexed={};var r=[],p={},reg=[%1],"+"d=Traversal.getDocument(e0),c=d.body?'toUpperCase':'toString';";var getElementById=MSIE?function(document,id){var result=document.all[id]||null;if(!result||result.id==id)return result;for(var i=0;i<result.length;i++){if(result[i].id==id)return result[i]}return null}:function(document,id){return document.getElementById(id)};var indexed={};function register(element){var uid=INDEXED?element.sourceIndex:assignID(element);if(!indexed[uid]){var elements=indexed[uid]={};var children=MSIE?element.children||element.childNodes:element.childNodes;var index=0;var child;for(var i=0;(child=children[i]);i++){if(Traversal.isElement(child)){elements[INDEXED?child.sourceIndex:assignID(child)]=++index}}elements.length=index}return uid};var fn;var index;var reg;var wild;var list;var dup;var cache={};var parser=new Parser({"^ \\*:root":function(match){wild=false;var replacement="e%2=d.documentElement;if(Traversal.contains(e%1,e%2)){";return format(replacement,index++,index)}," (\\*|[\\w-]+)#([\\w-]+)":function(match,tagName,id){wild=false;var replacement="var e%2=getElementById(d,'%4');if(";if(tagName!="*")replacement+="e%2.nodeName=='%3'[c]()&&";replacement+="Traversal.contains(e%1,e%2)){";if(list)replacement+=format("i%1=n%1.length;",list);return format(replacement,index++,index,tagName,id)}," (\\*|[\\w-]+)":function(match,tagName){dup++;wild=tagName=="*";var replacement=VAR;replacement+=(wild&&MSIE5)?"all":"getElementsByTagName('%3')";replacement+=";for(i%2=0;(e%2=n%2[i%2]);i%2++){";return format(replacement,index++,list=index,tagName)},">(\\*|[\\w-]+)":function(match,tagName){var children=MSIE&&list;wild=tagName=="*";var replacement=VAR;replacement+=children?"children":"childNodes";if(!wild&&children)replacement+=".tags('%3')";replacement+=";for(i%2=0;(e%2=n%2[i%2]);i%2++){";if(wild){replacement+="if(e%2.nodeType==1){";wild=MSIE5}else{if(!children)replacement+="if(e%2.nodeName=='%3'[c]()){"}return format(replacement,index++,list=index,tagName)},"([+~])(\\*|[\\w-]+)":function(match,combinator,tagName){var replacement="";if(wild&&MSIE)replacement+="if(e%1.tagName!='!'){";wild=false;var direct=combinator=="+";if(!direct){replacement+="while(";dup=2}replacement+="e%1=Traversal.getNextElementSibling(e%1)";replacement+=(direct?";":"){")+"if(e%1";if(tagName!="*")replacement+="&&e%1.nodeName=='%2'[c]()";replacement+="){";return format(replacement,index,tagName)},"#([\\w-]+)":function(match,id){wild=false;var replacement="if(e%1.id=='%2'){";if(list)replacement+=format("i%1=n%1.length;",list);return format(replacement,index,id)},"\\.([\\w-]+)":function(match,className){wild=false;reg.push(new RegExp("(^|\\s)"+rescape(className)+"(\\s|$)"));return format("if(reg[%2].test(e%1.className)){",index,reg.length-1)},":not\\((\\*|[\\w-]+)?([^)]*)\\)":function(match,tagName,filters){var replacement=(tagName&&tagName!="*")?format("if(e%1.nodeName=='%2'[c]()){",index,tagName):"";replacement+=parser.exec(filters);return"if(!"+replacement.slice(2,-1).replace(/\)\{if\(/g,"&&")+"){"},":nth(-last)?-child\\(([^)]+)\\)":function(match,last,args){wild=false;last=format("indexed[p%1].length",index);var replacement="if(p%1!==e%1.parentNode.";replacement+=INDEXED?"sourceIndex":"base2ID";replacement+=")p%1=register(e%1.parentNode);var i=indexed[p%1]["+ID+"];if(";return format(replacement,index)+Parser._nthChild(match,args,"i",last,"!","&&","%","==")+"){"},":([\\w-]+)(\\(([^)]+)\\))?":function(match,pseudoClass,$2,args){return"if("+format(Selector.pseudoClasses[pseudoClass],index,args||"")+"){"},"\\[([\\w-]+)\\s*([^=]?=)?\\s*([^\\]]*)\\]":function(match,attr,operator,value){if(operator){if(attr=="class")attr=="className";else if(attr=="for")attr=="htmlFor";attr=format("(e%1.getAttribute('%2')||e%1['%2'])",index,attr)}else{attr=format("Element.getAttribute(e%1,'%2')",index,attr)}var replacement=Selector.operators[operator||""];if(instanceOf(replacement,RegExp)){reg.push(new RegExp(format(replacement.source,rescape(parser.unescape(value)))));replacement="reg[%2].test(%1)";value=reg.length-1}return"if("+format(replacement,attr,value)+"){"}});Selector.parse=function(selector){if(!cache[selector]){reg=[];fn="";var selectors=parser.escape(selector).split(",");forEach(selectors,function(selector,label){index=list=dup=0;var block=parser.exec(selector);if(wild&&MSIE){block+=format("if(e%1.tagName!='!'){",index)}var store=(label||dup>1)?TEST:"";block+=format(store+STORE,index);var braces=match(block,/\{/g).length;while(braces--)block+="}";fn+=block});eval(format(FN,reg)+parser.unescape(fn)+"return s?null:r}");cache[selector]=fn}return cache[selector]}};AbstractView.implement(ViewCSS);Document.implement(DocumentSelector);Document.implement(DocumentEvent);Document.implement(EventTarget);Element.implement(ElementSelector);Element.implement(EventTarget);var HTMLDocument=Document.extend({"@!(document.nodeType)":{nodeType:9},"@!(document.getElementsByClassName)":{getElementsByClassName:function(document,classNames){return this.matchAll(document,"."+classNames.join("."))}}},{"@(document.activeElement===undefined)":{bind:function(document){this.base(document);document.activeElement=null;document.addEventListener("focus",function(event){document.activeElement=event.target},false);return document}}});var HTMLElement=Element.extend({addClass:function(element,className){if(!this.hasClass(element,className)){element.className+=(element.className?" ":"")+className;return className}},hasClass:function(element,className){var regexp=new RegExp("(^|\\s)"+className+"(\\s|$)");return regexp.test(element.className)},removeClass:function(element,className){var regexp=new RegExp("(^|\\s)"+className+"(\\s|$)");element.className=element.className.replace(regexp,"$2");return className},"@!(element.getElementsByClassName)":{getElementsByClassName:function(element,classNames){return this.matchAll(element,"."+classNames.join("."))}}},{bindings:{},tags:"*",extend:function(){var binding=base(this,arguments);var tags=(binding.tags||"").toUpperCase().split(",");forEach(tags,function(tagName){HTMLElement.bindings[tagName]=binding});return binding},"@!(element.ownerDocument)":{bind:function(element){this.base(element);element.ownerDocument=Traversal.getOwnerDocument(element);return element}}});extend(DOM,"bind",function(node){if(typeof node.className=="string"){(HTMLElement.bindings[node.tagName]||HTMLElement).bind(node)}else if(node.body!==undefined){HTMLDocument.bind(node)}else{this.base(node)}return node});eval(this.exports)};new function(_){var JSB=new base2.Namespace(this,{name:"JSB",version:"0.6",imports:"DOM",exports:"Binding,Rule,RuleList"});eval(this.imports);var Call=function(context,method,args,rank){this.call=function(){method.apply(context,args)};this.rank=rank||100};var System=new Base({ready:false,_deferred:new Array2,defer:function(method,rank){var deferred=function(){if(System._deferred){System._deferred.push(new Call(this,method,arguments,rank))}else{method.apply(this,arguments)}};return deferred},onload:function(){if(!System.ready){System.ready=true;DOM.bind(document);System._deferred.sort(function(a,b){return a.rank-b.rank});System._deferred.invoke("call");delete System._deferred;setTimeout(function(){EventTarget.dispatchEvent(document,"ready")},0)}}});EventTarget.addEventListener(document,"DOMContentLoaded",System.onload);extend(Event,{PATTERN:/^on(DOMContentLoaded|[a-z]+)$/,cancel:function(event){event.stopPropagation();event.preventDefault();return false}});extend(HTMLElement.prototype,"extend",function(name,value){if(!Base._prototyping&&Event.PATTERN.test(name)&&typeof value=="function"){EventTarget.addEventListener(this,name.slice(2),value);return this}if(arguments.length==2&&name=="style"){extend(this.style,value);return this}return base(this,arguments)});extend(EventTarget,{addEventListener:function(target,type,listener,context){if(type.indexOf("document")==0){type=type.slice(8);context=target;target=Traversal.getOwnerDocument(target)}this.base(target,type,listener,context)},removeEventListener:function(target,type,listener){if(type.indexOf("document")==0){type=type.slice(8);target=Traversal.getOwnerDocument(target)}this.base(target,type,listener)}});var Binding=Abstract.extend();var Rule=Base.extend({constructor:function(selector,binding){this.selector=instanceOf(selector,Selector)?selector:new Selector(selector);if(typeof binding!="function"){binding=Binding.extend(binding)}this.binding=binding;var bound={};this.bind=function(element){var uid=assignID(element);if(!bound[uid]){bound[uid]=true;binding(DOM.bind(element))}};this.apply()},binding:null,selector:null,apply:System.defer(function(){forEach(this.selector.exec(document),this.bind)}),bind:function(element){},refresh:function(){this.apply()},toString:function(){return String(this.selector)}});var RuleList=Collection.extend({constructor:function(rules){this.base(rules);this.globalize()},globalize:System.defer(function(){var COMMA=/\s*,\s*/;var ID=/^#[\w-]+$/;forEach(this,function(rule,selector){forEach(selector.split(COMMA),function(selector){if(ID.test(selector)){var name=ViewCSS.toCamelCase(selector.slice(1));window[name]=Document.matchSingle(document,selector)}})})},10),refresh:function(){this.invoke("refresh")}},{Item:Rule});eval(this.exports)};new function(_){eval(base2.namespace);var DEFAULT="@0";var IGNORE=RegGrp.IGNORE;Colorizer=RegGrp.extend({constructor:function(values,patterns,properties){this.patterns=patterns||{};this.extend(properties);this.base(values)},patterns:null,tabStop:4,urls:true,copy:function(){var colorizer=this.base();colorizer.patterns=copy(this.patterns);return colorizer},exec:function(text){text=this.base(this.escape(text));if(!arguments[1]){text=this._parseWhiteSpace(text);if(this.urls)text=Colorizer.urls.exec(text)}return this.unescape(text)},escape:function(text){return String(text).replace(/</g,"\x01").replace(/&/g,"\x02")},store:function(pattern,replacement){if(!instanceOf(pattern,RegGrp.Item)){if(typeof replacement=="string"){replacement=replacement.replace(/@(\d)/,function(match,index){return format(Colorizer.$FORMAT,pattern,index)})}pattern=this.patterns[pattern]||Colorizer.patterns[pattern]||pattern;if(instanceOf(pattern,RegExp))pattern=pattern.source;pattern=this.escape(pattern)}this.base(pattern,replacement)},unescape:function(text){return text.replace(/\x01/g,"&lt;").replace(/\x02/g,"&amp;")},_parseWhiteSpace:function(text){var tabStop=this.tabStop;if(tabStop>0){var tab=Array(tabStop+1).join(" ");return text.replace(Colorizer.TABS,function(match){match=match.replace(Colorizer.TAB,tab);if(tabStop>1){var padding=(match.length-1)%tabStop;if(padding)match=match.slice(0,-padding)}return match.replace(/ /g,"&nbsp;")})}},"@MSIE":{_parseWhiteSpace:function(text){return this.base(text).replace(/\r?\n/g,"<br>")}}},{$FORMAT:'<span class="%1">$%2</span>',DEFAULT:DEFAULT,IGNORE:IGNORE,TAB:/\t/g,TABS:/\n([\t \xa0]+)/g,init:function(){forEach(this.patterns,function(pattern,name,patterns){if(instanceOf(pattern,Array)){patterns[name]=reduce(pattern,function(group,name){group.add(patterns[name]);return group},new RegGrp)}});this.urls=this.patterns.urls.copy();this.urls.storeAt(0,'<a href="mailto:$0">$0</a>');this.urls.storeAt(1,'<a href="$0">$0</a>')},patterns:{block_comment:/\/\*[^*]*\*+([^\/][^*]*\*+)*\//,email:/([\w.+-]+@[\w.-]+\.\w+)/,line_comment:/\/\/[^\r\n]*/,number:/\b[+-]?(\d*\.?\d+|\d+\.?\d*)([eE][+-]?\d+)?\b/,string1:/'(\\.|[^'\\])*'/,string2:/"(\\.|[^"\\])*"/,url:/(http:\/\/+[\w\/\-%&#=.,?+$]+)/,comment:["block_comment","line_comment"],string:["string1","string2"],urls:["email","url"]},urls:null,"@KHTML":{$FORMAT:'<span class="%1">$$%2</span>'}});Colorizer.xml=new Colorizer({comment:DEFAULT,cdata:IGNORE,pi:DEFAULT,tag:"$1@2",attribute:'@1=<span class="attribute value">$2</span>',entity:DEFAULT,text:IGNORE},{attribute:/(\w+)=("[^"]*"|'[^']*')/,cdata:/<!\[CDATA\[([^\]]|\][^\]]|\]\][^>])*\]\]>/,comment:/<!\s*(--([^-]|[\r\n]|-[^-])*--\s*)>/,entity:/&#?\w+;/,pi:/<\?[\w-]+[^>]+>/,tag:/(<\/?)([\w:-]+)/,text:/[>;][^<>&]*/},{tabStop:1});Colorizer.html=new Colorizer({conditional:DEFAULT,doctype:DEFAULT,inline:function(match,tagName,attributes,cdata){return Colorizer.html.processCDATA(tagName,attributes,cdata)}},{conditional:/<!(--)?\[[^\]]*\]>|<!\[endif\](--)?>/,doctype:/<!DOCTYPE[^>]+>/,inline:/<(script|style)([^>]*)>((\\.|[^\\])*)<\/\1>/},{tabStop:1,CDATA:'&lt;<span class="tag">%1</span>%2&gt;%3&lt;/<span class="tag">%1</span>&gt;',processCDATA:function(tagName,attributes,cdata){return format(this.CDATA,tagName,this.exec(attributes,true),cdata)}});Colorizer.html.merge(Colorizer.xml);Colorizer.css=new Colorizer({comment:DEFAULT,at_rule:DEFAULT,bracketed:IGNORE,selector:"@1{",special:"@1:",property:'@1:<span class="property value">$2</span>'},{at_rule:/@[\w\s]+/,bracketed:/\([^'\x22)]*\)/,comment:Colorizer.patterns.block_comment,property:/(\w[\w-]*\s*):([^;}]+)/,special:/(\-[\w-]*\s*):/,selector:/([\w-:\[.#][^{};]*)\{/});Colorizer.javascript=new Colorizer({string:DEFAULT,conditional:DEFAULT,comment:DEFAULT,regexp:"$1@2",number:DEFAULT,special:DEFAULT,global:DEFAULT,keyword:DEFAULT},{conditional:/\/\*@if\s*\([^\)]*\)|\/\*@[\s\w]*|@\*\/|\/\/@\w+|@else[\s\w]*/,global:/\b(clearInterval|clearTimeout|constructor|document|escape|hasOwnProperty|Infinity|isNaN|NaN|parseFloat|parseInt|prototype|setInterval|setTimeout|toString|unescape|valueOf|window)\b/,keyword:/\b(&&|\|\||arguments|break|case|continue|default|delete|do|else|false|for|function|if|in|instanceof|new|null|return|switch|this|true|typeof|var|void|while|with|undefined)\b/,regexp:/([\[(\^=,{}:;&|!*?]\s*)(\/(\\\/|[^\/*])(\\.|[^\/\n\\])*\/[mgi]*)/,special:/\b(alert|catch|confirm|eval|finally|prompt|throw|try)\b/});Colorizer["html-multi"]=Colorizer.html.union({inline:function(match,tagName,attributes,cdata){var engine=tagName=="style"?"css":"javascript";cdata=Colorizer[engine].exec(cdata,true);cdata=format('<span class="%1">%2</span>',engine,cdata);return Colorizer.html.processCDATA(tagName,attributes,cdata)}})};eval(base2.namespace);eval(DOM.namespace);eval(JSB.namespace);var ATTRIBUTE=/(\w+)=([^"'\s]+)/g;var QUOTE='<blockquote cite="#%1">\n%3\n<address>'+'<a href="#%1" rel="bookmark">%2</a></address>\n</blockquote>';var TIDY=new RegGrp({"(<\\/?)(\\w+)([^>]*)":function($,lt,tagName,attributes){return lt+tagName.toLowerCase()+attributes.replace(ATTRIBUTE,function($,attribute,value){return attribute.toLowerCase()+'"'+value+'"'})},"&nbsp;":" "});Colorizer.javascript.store("\\b(assignID|base|base2|base2ID|every|extend|filter|forEach|"+"format|implement|instanceOf|invoke|K|map|pluck|reduce|rescape|slice|some|trim)\\b",'<span class="base2">$0</span>');function updateFlag(){this.nextSibling.style.color=this.value?"#898E79":"#A03333"};new RuleList({"pre":{ondocumentready:function(){var names=this.className.split(/\s+/);for(var i=0;i<names.length;i++){var engine=names[i];var colorizer=Colorizer[engine];if(instanceOf(colorizer,Colorizer)){var textContent=Traversal.getTextContent(this);this.setAttribute("originalText",textContent);this.innerHTML=colorizer.exec(textContent);this.addClass("highlight");if(engine=="html-multi")this.addClass("html");break}}}},"input.required,textarea.required":{ondocumentready:updateFlag,ondocumentmouseup:updateFlag,ondocumentkeyup:updateFlag},"li.comment:not(.disabled)":{ondocumentready:function(){var comment=this;var button=document.createElement("button");Traversal.setTextContent(button,"Quote");comment.appendChild(button);button.onclick=function(){var textarea=document.matchSingle("textarea");var id=comment.id;var cite=comment.matchSingle("cite:last-child");var author=Traversal.getTextContent(cite)||"comment #"+id;author=author.replace(/(^\s*comment(\s+by)?\s)|(\s\W\s.*$)/gi,"");var selectedText="";if(window.getSelection){selectedText=String(window.getSelection())}else if(document.selection){selectedText=document.selection.createRange().text}if(selectedText){var quote="<p>"+trim(selectedText)+"</p>"}else{var text=comment.matchSingle("div.comment-text").cloneNode(true);forEach(Element.matchAll(text,"pre"),function(pre){Traversal.setTextContent(pre,pre.getAttribute("originalText"));pre.removeAttribute("originalText");pre.removeAttribute("style");pre.removeAttribute("base2ID")});forEach(Element.matchAll(text,"img"),function(img){img.parentNode.replaceChild(document.createTextNode(img.alt),img)});quote=trim(TIDY.exec(text.innerHTML))}var html=format(QUOTE,id,author,quote);textarea.value=trim(textarea.value+"\n"+html);textarea.focus()}},onmouseover:function(){this.matchSingle("button").style.visibility="visible"},onmouseout:function(){this.matchSingle("button").style.visibility=""}}});
