var base2={};new function(_){var Base=function(){};Base.prototype={extend:function(c){if(arguments.length>1){var d=this[c];var e=arguments[1];if(typeof e=="function"&&d&&/\bbase\b/.test(e)){var f=e;e=function(){var a=this.base;this.base=d;var b=f.apply(this,arguments);this.base=a;return b};e.method=f;e.ancestor=d}this[c]=e}else if(c){var g=Base.prototype.extend;if(Base._prototyping){var h,i=0,members=["constructor","toString","valueOf"];while(h=members[i++])if(c[h]!=Object.prototype[h]){g.call(this,h,c[h])}}else if(typeof this!="function"){g=this.extend||g}for(h in c)if(!Object.prototype[h]){g.call(this,h,c[h])}}return this},base:Base};Base.extend=function(b,c){var d=Base.prototype.extend;Base._prototyping=true;var e=new this;d.call(e,b);delete Base._prototyping;var constructor=e.constructor;var f=e.constructor=function(){if(!Base._prototyping){if(this._constructing||this.constructor==f){this._constructing=true;constructor.apply(this,arguments);delete this._constructing}else{var a=arguments[0];if(a!=null){(a.extend||d).call(a,e)}return a}}};for(var i in Base)f[i]=this[i];f.ancestor=this;f.base=Base.base;f.prototype=e;f.toString=this.toString;d.call(f,c);if(typeof f.init=="function")f.init();return f};Base=Base.extend({constructor:function(){this.extend(arguments[0])}},{ancestor:Object,base:Base,implement:function(a){if(typeof a=="function"){a(this.prototype)}else{this.prototype.extend(a)}return this}});var Legacy=typeof $Legacy=="undefined"?{}:$Legacy;var K=function(k){return k};var assert=function(a,b,c){if(!a){throw new(c||Error)(b||"Assertion failed.");}};var assertType=function(a,b,c){if(b){var d=typeof b=="function"?instanceOf(a,b):typeof a==b;assert(d,c||"Invalid type.",TypeError)}};var copy=function(a){var b=new Function;b.prototype=a;return new b};var format=function(c){var d=arguments;return String(c).replace(/%([1-9])/g,function(a,b){return b<d.length?d[b]:a})};var $instanceOf=Legacy.instanceOf||new Function("o,k","return o instanceof k");var instanceOf=function(a,b){assertType(b,"function","Invalid 'instanceOf' operand.");if($instanceOf(a,b))return true;if(a!=null)switch(b){case Object:return true;case Number:case Boolean:case Function:case String:return typeof a==typeof b.prototype.valueOf();case Array:return!!(a.join&&a.splice&&!arguments.callee(a,Function));case Date:return!!a.getTimezoneOffset;case RegExp:return String(a.constructor.prototype)==String(new RegExp)}return false};var match=function(a,b){return String(a).match(b)||[]};var RESCAPE=/([\/()[\]{}|*+-.,^$?\\])/g;var rescape=function(a){return String(a).replace(RESCAPE,"\\$1")};var $slice=Array.prototype.slice;var slice=function(a){return $slice.apply(a,$slice.call(arguments,1))};var TRIM=/^\s+|\s+$/g;var trim=function(a){return String(a).replace(TRIM,"")};var base=function(a,b){return a.base.apply(a,b)};var extend=function(a){assert(a!=Object.prototype,"Object.prototype is verboten!");return Base.prototype.extend.apply(a,slice(arguments,1))};var $ID=1;var assignID=function(a){if(!a.base2ID)a.base2ID="b2_"+$ID++;return a.base2ID};if(typeof StopIteration=="undefined"){StopIteration=new Error("StopIteration")}var forEach=function(a,b,c){if(a==null)return;if(typeof a=="function"){var d=Function}else if(typeof a.forEach=="function"&&a.forEach!=arguments.callee){a.forEach(b,c);return}else if(typeof a.length=="number"){forEach.Array(a,b,c);return}forEach.Function(d||Object,a,b,c)};forEach.Array=function(a,b,c){var i,length=a.length;if(typeof a=="string"){for(i=0;i<length;i++){b.call(c,a.charAt(i),i,a)}}else{for(i=0;i<length;i++){b.call(c,a[i],i,a)}}};forEach.Function=Legacy.forEach||function(a,b,c,d){for(var e in b){if(a.prototype[e]===undefined){c.call(d,b[e],e,b)}}};Base.forEach=function(a,b,c){forEach.Function(this,a,b,c)};Function.prototype.prototype={};if("".replace(/^/,String)){extend(String.prototype,"replace",function(a,b){if(typeof b=="function"){if(instanceOf(a,RegExp)){var c=a;var d=c.global;if(d==null)d=/(g|gi)$/.test(c);if(d)c=new RegExp(c.source)}else{c=new RegExp(rescape(a))}var e,string=this,result="";while(string&&(e=c.exec(string))){result+=string.slice(0,e.index)+b.apply(this,e);string=string.slice(e.index+e[0].length);if(!d)break}return result+string}else{return base(this,arguments)}})}var Abstract=Base.extend({constructor:function(){throw new TypeError("Class cannot be instantiated.");}});var Module=Abstract.extend(null,{extend:function(c,d){var e=this.base();forEach(this,function(a,b){if(!Module[b]&&b!="init"){extend(e,b,a)}});e.implement(c);extend(e,d);if(typeof e.init=="function")e.init();return e},implement:function(c){var d=this;if(typeof c=="function"){d.base(c);forEach(c,function(a,b){if(!Module[b]&&b!="init"){extend(d,b,a)}})}else{Base.forEach(extend({},c),function(a,b){if(typeof a=="function"){a=function(){base;return d[b].apply(d,[this].concat(slice(arguments)))}}if(!Module[b])extend(this,b,a)},d.prototype);extend(d,c)}return d}});var Enumerable=Module.extend({every:function(c,d,e){var f=true;try{this.forEach(c,function(a,b){f=d.call(e,a,b,c);if(!f)throw StopIteration;})}catch(error){if(error!=StopIteration)throw error;}return!!f},filter:function(d,e,f){return this.reduce(d,function(a,b,c){if(e.call(f,b,c,d)){a[a.length]=b}return a},new Array2)},invoke:function(b,c){var d=slice(arguments,2);return this.map(b,(typeof c=="function")?function(a){if(a!=null)return c.apply(a,d)}:function(a){if(a!=null)return a[c].apply(a,d)})},map:function(c,d,e){var f=new Array2;this.forEach(c,function(a,b){f[f.length]=d.call(e,a,b,c)});return f},pluck:function(b,c){return this.map(b,function(a){if(a!=null)return a[c]})},reduce:function(c,d,e,f){this.forEach(c,function(a,b){e=d.call(f,e,a,b,c)});return e},some:function(c,d,e){return!this.every(c,function(a,b){return!d.call(e,a,b,c)})}},{forEach:forEach});var IArray=Module.extend({combine:function(d,e){if(!e)e=d;return this.reduce(d,function(a,b,c){a[b]=e[c];return a},{})},copy:function(a){return this.concat(a)},contains:function(a,b){return this.indexOf(a,b)!=-1},forEach:forEach.Array,indexOf:function(a,b,c){var d=a.length;if(c==null){c=0}else if(c<0){c=Math.max(0,d+c)}for(var i=c;i<d;i++){if(a[i]===b)return i}return-1},insertAt:function(a,b,c){this.splice(a,c,0,b);return b},insertBefore:function(a,b,c){var d=this.indexOf(a,c);if(d==-1)this.push(a,b);else this.splice(a,d,0,b);return b},lastIndexOf:function(a,b,c){var d=a.length;if(c==null){c=d-1}else if(from<0){c=Math.max(0,d+c)}for(var i=c;i>=0;i--){if(a[i]===b)return i}return-1},remove:function(a,b){var c=this.indexOf(a,b);if(c!=-1)this.removeAt(a,c);return b},removeAt:function(a,b){var c=a[b];this.splice(a,b,1);return c}});IArray.prototype.forEach=function(a,b){forEach.Array(this,a,b)};IArray.implement(Enumerable);forEach("concat,join,pop,push,reverse,shift,slice,sort,splice,unshift".split(","),function(b){IArray[b]=function(a){return Array.prototype[b].apply(a,slice(arguments,1))}});var Array2=function(){return IArray(this.constructor==IArray?Array.apply(null,arguments):arguments[0])};Array2.prototype=IArray.prototype;forEach(IArray,function(a,b,c){if(Array[b]){IArray[b]=Array[b];delete IArray.prototype[b]}Array2[b]=IArray[b]});var HASH="#"+Number(new Date);var KEYS=HASH+"keys";var VALUES=HASH+"values";var Hash=Base.extend({constructor:function(a){this[KEYS]=new Array2;this[VALUES]={};this.merge(a)},copy:function(){var c=new this.constructor(this);Base.forEach(this,function(a,b){if(typeof a!="function"&&b.charAt(0)!="#"){c[b]=a}});return c},exists:Legacy.exists||new Function("k",format("return('%1'+k)in this['%2']",HASH,VALUES)),fetch:function(a){return this[VALUES][HASH+a]},forEach:function(b,c){forEach(this[KEYS],function(a){b.call(c,this.fetch(a),a,this)},this)},keys:function(a,b){var c=this[KEYS]||new Array2;switch(arguments.length){case 0:return c.copy();case 1:return c[a];default:return c.slice(a,b)}},merge:function(d){forEach(arguments,function(c){forEach(c,function(a,b){this.store(b,a)},this)},this);return this},remove:function(a){var b=this.fetch(a);this[KEYS].remove(String(a));delete this[VALUES][HASH+a];return b},store:function(a,b){if(arguments.length==1)b=a;if(!this.exists(a)){this[KEYS].push(String(a))}this[VALUES][HASH+a]=b;return b},toString:function(){return String(this[KEYS])},union:function(a){return this.merge.apply(this.copy(),arguments)},values:function(a,b){var c=this.map(K);switch(arguments.length){case 0:return c;case 1:return c[a];default:return c.slice(a,b)}}});Hash.implement(Enumerable);var Collection=Hash.extend({add:function(a,b){assert(!this.exists(a),"Duplicate key.");return this.store.apply(this,arguments)},count:function(){return this[KEYS].length},indexOf:function(a){return this[KEYS].indexOf(String(a))},insertAt:function(a,b,c){assert(!this.exists(b),"Duplicate key.");this[KEYS].insertAt(a,String(b));return this.store.apply(this,slice(arguments,1))},item:function(a){return this.fetch(this[KEYS][a])},removeAt:function(a){return this.remove(this[KEYS][a])},reverse:function(){this[KEYS].reverse();return this},sort:function(c){if(c){var d=this;this[KEYS].sort(function(a,b){return c(d.fetch(a),d.fetch(b),a,b)})}else this[KEYS].sort();return this},store:function(a,b){if(arguments.length==1)b=a;b=this.constructor.create.apply(this.constructor,arguments);return this.base(a,b)},storeAt:function(a,b){assert(a<this.count(),"Index out of bounds.");arguments[0]=this[KEYS][a];return this.store.apply(this,arguments)}},{Item:null,create:function(a,b){if(this.Item&&!instanceOf(b,this.Item)){b=new this.Item(a,b)}return b},extend:function(a,b){var c=this.base(a);c.create=this.create;extend(c,b);if(!c.Item){c.Item=this.Item}else if(typeof c.Item!="function"){c.Item=(this.Item||Base).extend(c.Item)}if(typeof c.init=="function")c.init();return c}});var RegGrp=Collection.extend({constructor:function(a,b){this.base(a);if(typeof b=="string"){this.global=/g/.test(b);this.ignoreCase=/i/.test(b)}},global:true,ignoreCase:false,exec:function(d,e){if(arguments.length==1){var f=this[KEYS];var g=this[VALUES];e=function(a){if(!a)return"";var b=1,i=0;while(a=g[HASH+f[i++]]){if(arguments[b]){var c=a.replacement;switch(typeof c){case"function":return c.apply(null,slice(arguments,b));case"number":return arguments[b+c];default:return c}}else b+=a.length+1}}}var h=(this.global?"g":"")+(this.ignoreCase?"i":"");return String(d).replace(new RegExp(this,h),e)},test:function(a){return this.exec(a)!=a},toString:function(){var d=0;return"("+this.map(function(b){var c=String(b).replace(/\\(\d+)/g,function($,a){return"\\"+(1+Number(a)+d)});d+=b.length+1;return c}).join(")|(")+")"}},{IGNORE:"$0",init:function(){forEach("add,exists,fetch,remove,store".split(","),function(b){extend(this,b,function(a){if(instanceOf(a,RegExp)){a=a.source}return base(this,arguments)})},this.prototype)}});RegGrp.Item=Base.extend({constructor:function(a,b){var c=/\\./g;var d=/(['"])\1\+(.*)\+\1\1$/;a=instanceOf(a,RegExp)?a.source:String(a);if(typeof b=="number")b=String(b);else if(b==null)b="";this.length=match(a.replace(c,"").replace(/\[[^\]]+\]/g,""),/\(/g).length;if(typeof b=="string"&&/\$(\d+)/.test(b)){if(/^\$\d+$/.test(b)){b=parseInt(b.slice(1))}else{var i=this.length+1;var Q=/'/.test(b.replace(c,""))?'"':"'";b=b.replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/\$(\d+)/g,Q+"+(arguments[$1]||"+Q+Q+")+"+Q);b=new Function("return "+Q+b.replace(d,"$1")+Q)}}this.replacement=b;this.toString=function(){return a||""}},length:0,replacement:""});var Namespace=Base.extend({constructor:function(c,d){this.extend(d);this.toString=function(){return format("[base2.%1]",this.name)};if(typeof this.init=="function")this.init();if(this.name!="base2"){this.namespace=format("var %1=base2.%1;",this.name)}var e="var base="+base+";";var f=("base2,lang,"+this.imports).split(",");c.imports=Enumerable.reduce(f,function(a,b){if(base2[b])a+=base2[b].namespace;return a},e);var e=format("base2.%1=%1;",this.name);var g=this.exports.split(",");c.exports=Enumerable.reduce(g,function(a,b){if(b){this.namespace+=format("var %2=%1.%2;",this.name,b);a+=format("if(!%1.%2)%1.%2=%2;base2.%2=%1.%2;",this.name,b)}return a},e,this);if(this.name!="base2"){base2.namespace+=format("var %1=base2.%1;",this.name)}},exports:"",imports:"",namespace:"",name:""});base2=new Namespace(this,{name:"base2",version:"0.8 (alpha)",exports:"Base,Abstract,Module,Enumerable,Array2,Hash,Collection,RegGrp,Namespace"});base2.toString=function(){return"[base2]"};eval(this.exports);var lang=new Namespace(this,{name:"lang",version:base2.version,exports:"K,assert,assertType,assignID,copy,instanceOf,extend,format,forEach,match,rescape,slice,trim",init:function(){this.extend=extend;forEach(Enumerable.prototype,function(a,b){if(!Module[b]){this[b]=function(){return Enumerable[b].apply(Enumerable,arguments)};this.exports+=","+b}},this)}});eval(this.exports);base2.namespace+=lang.namespace};new function(_){var element=document.createElement("span");var jscript/*@cc_on=@_jscript_version@*/;var BOM={userAgent:"",init:function(){var a/*@cc_on=true@*/;var b=navigator.userAgent;if(!a)b=b.replace(/MSIE\s[\d.]+/,"");b=b.replace(/([a-z])[\s\/](\d)/gi,"$1$2");this.userAgent=navigator.platform+" "+b},detect:function(a){var r=false;var b=a.charAt(0)=="!";a=a.replace(/^\!?(if\s*|platform\s+)?/,"").replace(/^(["']?)([^\(].*)(\1)$/,"/($2)/i.test(BOM.userAgent)");try{eval("r=!!"+a)}catch(error){}return Boolean(b^r)}};base2.extend(BOM,{name:"BOM",version:"0.9",exports:"detect,Window"});BOM=new base2.Namespace(this,BOM);eval(this.imports);var _extend=Base.prototype.extend;Base.prototype.extend=function(a,b){if(typeof a=="string"&&a.charAt(0)=="@"){return BOM.detect(a.slice(1))?_extend.call(this,b):this}return _extend.apply(this,arguments)};if(BOM.detect("MSIE.+win")){var $closures={};BOM.$bind=function(b,c){if(!c||c.nodeType!=1){return b}var d=c.uniqueID;var e=assignID(b);$closures[e]=b;if(!$closures[d])$closures[d]={};var f=$closures[d][e];if(f)return f;c=null;b=null;var g=function(){var a=document.all[d];if(a)return $closures[e].apply(a,arguments)};g.cloneID=e;$closures[d][e]=g;return g};attachEvent("onunload",function(){$closures=null})}var Window=Module.extend(null,{verify:function(a){return(a&&a.Infinity)?a:null},"@MSIE":{verify:function(a){return(a==self)?self:this.base()}}});eval(this.exports)};new function(_){var DOM=new base2.Namespace(this,{name:"DOM",version:"0.9 (alpha)",imports:"BOM",exports:"Node,Document,Element,Traversal,AbstractView,Event,EventTarget,DocumentEvent,Selector,DocumentSelector,ElementSelector,StaticNodeList,ViewCSS,HTMLDocument,HTMLElement"});eval(this.imports);var Interface=Module.extend(null,{createDelegate:function(b){this[b]=function(a){var m=(a.base&&a.base==a[b].ancestor)?"base":b;return a[m].apply(a,slice(arguments,1))}},extend:function(c,d){var e=this.base();forEach(c,function(a,b){if(typeof a=="function"&&!e[b]){e.createDelegate(b)}else if(b.charAt(0)=="@"){forEach(a,arguments.callee)}});e.implement(c);extend(e,d);if(typeof e.init=="function")e.init();return e},"@!(element.addEventListener.apply)":{createDelegate:function(c){this[c]=function(a){var m=(a.base&&a.base==a[c].ancestor)?"base":c;switch(arguments.length){case 1:return a[m]();case 2:return a[m](arguments[1]);case 3:return a[m](arguments[1],arguments[2]);case 4:return a[m](arguments[1],arguments[2],arguments[3])}var b=[],i=arguments.length;while(i-->1)b[i-1]="arguments["+i+"]";eval("var returnValue=object[m]("+b+")");return returnValue}}}});var Binding=Interface.extend(null,{extend:function(a,b){var c=this.bind;if(b){c=b.bind||c;delete b.bind}var d=this.base(a,b);extend(d,"bind",c);return d}});Binding.bind=function(a){return this(a)};var Traversal=Module.extend({getDefaultView:function(a){return this.getDocument(a).defaultView},getNextElementSibling:function(a){while(a&&(a=a.nextSibling)&&!this.isElement(a))continue;return a},getNodeIndex:function(a){var b=0;while(a&&(a=a.previousSibling))b++;return b},getOwnerDocument:function(a){return a.ownerDocument},getPreviousElementSibling:function(a){while(a&&(a=a.previousSibling)&&!this.isElement(a))continue;return a},getTextContent:function(a){return a[Traversal.$TEXT]},isEmpty:function(a){a=a.firstChild;while(a){if(a.nodeType==3||this.isElement(a))return false;a=a.nextSibling}return true},setTextContent:function(a,b){return a[Traversal.$TEXT]=b},"@MSIE":{getDefaultView:function(a){return this.getDocument(a).parentWindow},"@MSIE5":{getOwnerDocument:function(a){return a.ownerDocument||a.document}}}},{$TEXT:"textContent",contains:function(a,b){return this.isDocument(a)?a==this.getOwnerDocument(b):a!=b&&a.contains(b)},getDocument:function(a){return this.isDocument(a)?a:this.getOwnerDocument(a)},isDocument:function(a){return Boolean(a&&a.documentElement)},isElement:function(a){return Boolean(a&&a.attributes)},"@!(element.contains)":{contains:function(a,b){while(b&&(b=b.parentNode)&&a!=b)continue;return!!b}},"@MSIE":{$TEXT:"innerText"},"@MSIE5":{isElement:function(a){return this.base(a)&&a.tagName!="!"}}});var Node=Binding.extend({"@!(element.compareDocumentPosition)":{compareDocumentPosition:function(a,b){if(Traversal.contains(a,b)){return 4|16}else if(Traversal.contains(b,a)){return 2|8}var c=this.$getSourceIndex(a);var d=this.$getSourceIndex(b);if(c<d){return 4}else if(c>d){return 2}return 0}}},{$getSourceIndex:function(a){var b=0;while(a){b=Traversal.getNodeIndex(a)+"."+b;a=a.parentNode}return b},"@(element.sourceIndex)":{$getSourceIndex:function(a){return a.sourceIndex}}});var Document=Node.extend(null,{bind:function(a){this.base(a);AbstractView.bind(a.defaultView);return a}});Document.createDelegate("createElement");var Element=Node.extend({"@MSIE[67]":{getAttribute:function(a,b){if(a.className===undefined||b=="href"||b=="src"){return this.base(a,b,2)}var c=a.getAttributeNode(b);return c&&c.specified?c.nodeValue:null}},"@MSIE5.+win":{getAttribute:function(a,b){if(a.className===undefined||b=="href"||b=="src"){return this.base(a,b,2)}var c=a.attributes[this.$htmlAttributes[b.toLowerCase()]||b];return c?c.specified?c.nodeValue:null:this.base(a,b)}}},{$htmlAttributes:"",init:function(){var a=this.$htmlAttributes.toLowerCase().split(",");var b=this.$htmlAttributes.split(",");this.$htmlAttributes=Array2.combine(a,b)},"@MSIE5.+win":{$htmlAttributes:"colSpan,rowSpan,vAlign,dateTime,accessKey,tabIndex,encType,maxLength,readOnly,longDesc"}});Element.createDelegate("setAttribute");extend(DOM,{bind:function(a){switch(a.nodeType){case 1:return Element.bind(a);case 9:return Document.bind(a);default:return Node.bind(a)}return a}});var _bound={};var _bind=function(a){if(a){var b=assignID(a);if(!_bound[b]){DOM.bind(a);_bound[b]=true}}return a};var AbstractView=Binding.extend();var Event=Binding.extend({"@!(document.createEvent)":{initEvent:function(a,b,c,d){a.type=b;a.bubbles=c;a.cancelable=d},"@MSIE":{initEvent:function(a){base(this,arguments);a.cancelBubble=!a.bubbles},preventDefault:function(a){if(a.cancelable!==false){a.returnValue=false}},stopPropagation:function(a){a.cancelBubble=true}}}},{"@MSIE":{"Mac":{bind:function(a){return this.base(extend({preventDefault:function(){if(this.cancelable!==false){this.returnValue=false}}},a))}},"Windows":{bind:function(a){this.base(a);a.target=a.srcElement;return a}}}});var EventTarget=Interface.extend({"@!(element.addEventListener)":{addEventListener:function(a,b,c){var d=assignID(a);var e=c.cloneID||assignID(c);var f=this.$all[d];if(!f)f=this.$all[d]={};var g=f[b];var h=a["on"+b];if(!g){g=f[b]={};if(h)g[0]=h}g[e]=c;if(h!==undefined){a["on"+b]=this.$dispatch}},dispatchEvent:function(a,b){this.$dispatch.call(a,b)},removeEventListener:function(a,b,c){var d=this.$all[a.base2ID];if(d&&d[b]){delete d[b][c.base2ID]}},"@MSIE.+win":{addEventListener:function(a,b,c){this.base(a,b,this._bind(c,a))},dispatchEvent:function(a,b){b.target=a;try{a.fireEvent(b.type,b)}catch(error){this.base(a,b)}}}}},{_bind:function(a,b){var c=function(){return a.apply(b,arguments)};c.cloneID=assignID(a);return c},"@!(element.addEventListener)":{$all:{},$dispatch:function(a){var b=true;var c=EventTarget.$all[this.base2ID];if(c){a=Event.bind(a);var d=c[a.type];for(var i in d){b=d[i].call(this,a);if(a.returnValue===false)b=false;if(b===false)break}}return b},"@MSIE":{$dispatch:function(a){if(!a){var b=Window.verify(this)||Traversal.getDefaultView(this);a=b.event}return this.base(a)},"Windows":{_bind:function(a,b){return BOM.$bind(a,b)}}}}});extend(EventTarget,{addEventListener:function(a,b,c,d){if(d)c=this._bind(c,d);this.base(a,b,c,false)},dispatchEvent:function(a,b){if(typeof b=="string"){var c=b;var d=Traversal.getDocument(a);b=DocumentEvent.createEvent(d,"Events");Event.initEvent(b,c,false,false)}this.base(a,b)}});var DocumentEvent=Interface.extend({"@!(document.createEvent)":{createEvent:function(a){return Event.bind({})},"@(document.createEventObject)":{createEvent:function(a){return Event.bind(a.createEventObject())}}},"@KHTML":{createEvent:function(a,b){return this.base(a,b=="Events"?"UIEvents":b)}}});var DOMContentLoaded=new Base({fired:false,fire:function(){if(!DOMContentLoaded.fired){DOMContentLoaded.fired=true;setTimeout("base2.EventTarget.dispatchEvent(document,'DOMContentLoaded')",0)}},init:function(){EventTarget.addEventListener(document,"DOMContentLoaded",function(){DOMContentLoaded.fired=true});EventTarget.addEventListener(window,"load",DOMContentLoaded.fire)},"@(addEventListener)":{init:function(){this.base();addEventListener("load",DOMContentLoaded.fire,false)}},"@(attachEvent)":{init:function(){this.base();attachEvent("onload",DOMContentLoaded.fire)}},"@MSIE.+win":{init:function(){this.base();document.write("<script id=__ready defer src=//:><\/script>");document.all.__ready.onreadystatechange=function(){if(this.readyState=="complete"){this.removeNode();DOMContentLoaded.fire()}}}},"@KHTML":{init:function(){this.base();var a=setInterval(function(){if(/loaded|complete/.test(document.readyState)){clearInterval(a);DOMContentLoaded.fire()}},100)}}});DOMContentLoaded.init();var ViewCSS=Interface.extend({"@!(getComputedStyle)":{getComputedStyle:function(a,b){return b.currentStyle}}},{toCamelCase:function(c){return String(c).replace(/\-([a-z])/g,function(a,b){return b.toUpperCase()})}});extend(Document,{"@!(document.defaultView)":{bind:function(a){this.base(a);a.defaultView=Traversal.getDefaultView(a);return a}}});var NodeSelector=Interface.extend({"@!(element.matchSingle)":{matchAll:function(a,b){return new Selector(b).exec(a)},matchSingle:function(a,b){return new Selector(b).exec(a,1)}}});extend(NodeSelector.prototype,{matchAll:function(b){return extend(this.base(b),"item",function(a){return _bind(this.base(a))})},matchSingle:function(a){return _bind(this.base(a))}});var DocumentSelector=NodeSelector.extend();var ElementSelector=NodeSelector.extend({"@!(element.matchesSelector)":{matchesSelector:function(a,b){return new Selector(b).test(a)}}});var StaticNodeList=Base.extend({constructor:function(b){b=b||[];this.length=b.length;this.item=function(a){return b[a]}},length:0,forEach:function(a,b){var c=this.length;for(var i=0;i<c;i++){a.call(b,this.item(i),i,this)}},item:function(a){},"@(XPathResult)":{constructor:function(b){if(b&&b.snapshotItem){this.length=b.snapshotLength;this.item=function(a){return b.snapshotItem(a)}}else this.base(b)}}});StaticNodeList.implement(Enumerable);var Selector=Base.extend({constructor:function(a){this.toString=function(){return trim(a)}},exec:function(a,b){var c=this.$evaluate(a||document,b);return b?c:new StaticNodeList(c)},test:function(a){a.setAttribute("b2_test",true);var b=new Selector(this+"[b2_test]");var c=b.exec(Traversal.getOwnerDocument(a),1);a.removeAttribute("b2_test");return c==a},$evaluate:function(a,b){return Selector.parse(this)(a,b)}});var Parser=RegGrp.extend({constructor:function(){base(this,arguments);this.cache={};this.sorter=new RegGrp;this.sorter.add(/:not\([^)]*\)/,RegGrp.IGNORE);this.sorter.add(/([ >](\*|[\w-]+))([^: >+~]*)(:\w+-child(\([^)]+\))?)([^: >+~]*)/,"$1$3$6$4")},cache:null,ignoreCase:true,escape:function(b){var c=this._strings=[];return this.optimise(this.format(String(b).replace(Parser.ESCAPE,function(a){c.push(a.slice(1,-1));return"%"+c.length})))},format:function(a){return a.replace(Parser.WHITESPACE,"$1").replace(Parser.IMPLIED_SPACE,"$1 $2").replace(Parser.IMPLIED_ASTERISK,"$1*$2")},optimise:function(a){return this.sorter.exec(a.replace(Parser.WILD_CARD,">* "))},parse:function(a){return this.cache[a]||(this.cache[a]=this.unescape(this.exec(this.escape(a))))},unescape:function(a){return format(a,this._strings)}},{ESCAPE:/(["'])[^\1]*\1/g,IMPLIED_ASTERISK:/([\s>+~,]|[^(]\+|^)([#.:@])/g,IMPLIED_SPACE:/(^|,)([^\s>+~])/g,WHITESPACE:/\s*([\s>+~(),]|^|$)\s*/g,WILD_CARD:/\s\*\s/g,_nthChild:function(c,d,e,f,g,h,i,j){f=/last/i.test(c)?f+"+1-":"";if(!isNaN(d))d="0n+"+d;else if(d=="even")d="2n";else if(d=="odd")d="2n+1";d=d.split(/n\+?/);var a=(d[0]=="")?1:(d[0]=="-")?-1:parseInt(d[0]);var b=parseInt(d[1])||0;var g=a<0;if(g){a=-a;if(a==1)b++}var k=format(a==0?"%3%7"+(f+b):"(%4%3-%2)%6%1%70%5%4%3>=%2",a,b,e,f,h,i,j);if(g)k=g+"("+k+")";return k}});Selector.operators={"=":"%1=='%2'","~=":/(^| )%1( |$)/,"|=":/^%1(-|$)/,"^=":/^%1/,"$=":/%1$/,"*=":/%1/};Selector.operators[""]="%1!=null";Selector.pseudoClasses={"checked":"e%1.checked","contains":"Traversal.getTextContent(e%1).indexOf('%2')!=-1","disabled":"e%1.disabled","empty":"Traversal.isEmpty(e%1)","enabled":"e%1.disabled===false","first-child":"!Traversal.getPreviousElementSibling(e%1)","last-child":"!Traversal.getNextElementSibling(e%1)","only-child":"!Traversal.getPreviousElementSibling(e%1)&&!Traversal.getNextElementSibling(e%1)","root":"e%1==Traversal.getDocument(e%1).documentElement"};new function(_){var MSIE=BOM.detect("MSIE");var MSIE5=BOM.detect("MSIE5");var INDEXED=BOM.detect("(element.sourceIndex)");var VAR="var p%2=0,i%2,e%2,n%2=e%1.";var ID=INDEXED?"e%1.sourceIndex":"assignID(e%1)";var TEST="var g="+ID+";if(!p[g]){p[g]=1;";var STORE="r[r.length]=e%1;if(s)return e%1;";var FN="fn=function(e0,s){indexed={};var r=[],p={},reg=[%1],"+"d=Traversal.getDocument(e0),c=d.body?'toUpperCase':'toString';";var getElementById=MSIE?function(a,b){var c=a.all[b]||null;if(!c||c.id==b)return c;for(var i=0;i<c.length;i++){if(c[i].id==b)return c[i]}return null}:function(a,b){return a.getElementById(b)};var indexed={};function register(a){var b=INDEXED?a.sourceIndex:assignID(a);if(!indexed[b]){var c=indexed[b]={};var d=MSIE?a.children||a.childNodes:a.childNodes;var e=0;var f;for(var i=0;(f=d[i]);i++){if(Traversal.isElement(f)){c[INDEXED?f.sourceIndex:assignID(f)]=++e}}c.length=e}return b};var fn;var index;var reg;var wild;var list;var dup;var cache={};var parser=new Parser({"^ \\*:root":function(a){wild=false;var b="e%2=d.documentElement;if(Traversal.contains(e%1,e%2)){";return format(b,index++,index)}," (\\*|[\\w-]+)#([\\w-]+)":function(a,b,c){wild=false;var d="var e%2=getElementById(d,'%4');if(";if(b!="*")d+="e%2.nodeName=='%3'[c]()&&";d+="Traversal.contains(e%1,e%2)){";if(list)d+=format("i%1=n%1.length;",list);return format(d,index++,index,b,c)}," (\\*|[\\w-]+)":function(a,b){dup++;wild=b=="*";var c=VAR;c+=(wild&&MSIE5)?"all":"getElementsByTagName('%3')";c+=";for(i%2=0;(e%2=n%2[i%2]);i%2++){";return format(c,index++,list=index,b)},">(\\*|[\\w-]+)":function(a,b){var c=MSIE&&list;wild=b=="*";var d=VAR;d+=c?"children":"childNodes";if(!wild&&c)d+=".tags('%3')";d+=";for(i%2=0;(e%2=n%2[i%2]);i%2++){";if(wild){d+="if(e%2.nodeType==1){";wild=MSIE5}else{if(!c)d+="if(e%2.nodeName=='%3'[c]()){"}return format(d,index++,list=index,b)},"([+~])(\\*|[\\w-]+)":function(a,b,c){var d="";if(wild&&MSIE)d+="if(e%1.tagName!='!'){";wild=false;var e=b=="+";if(!e){d+="while(";dup=2}d+="e%1=Traversal.getNextElementSibling(e%1)";d+=(e?";":"){")+"if(e%1";if(c!="*")d+="&&e%1.nodeName=='%2'[c]()";d+="){";return format(d,index,c)},"#([\\w-]+)":function(a,b){wild=false;var c="if(e%1.id=='%2'){";if(list)c+=format("i%1=n%1.length;",list);return format(c,index,b)},"\\.([\\w-]+)":function(a,b){wild=false;reg.push(new RegExp("(^|\\s)"+rescape(b)+"(\\s|$)"));return format("if(reg[%2].test(e%1.className)){",index,reg.length-1)},":not\\((\\*|[\\w-]+)?([^)]*)\\)":function(a,b,c){var d=(b&&b!="*")?format("if(e%1.nodeName=='%2'[c]()){",index,b):"";d+=parser.exec(c);return"if(!"+d.slice(2,-1).replace(/\)\{if\(/g,"&&")+"){"},":nth(-last)?-child\\(([^)]+)\\)":function(a,b,c){wild=false;b=format("indexed[p%1].length",index);var d="if(p%1!==e%1.parentNode.";d+=INDEXED?"sourceIndex":"base2ID";d+=")p%1=register(e%1.parentNode);var i=indexed[p%1]["+ID+"];if(";return format(d,index)+Parser._nthChild(a,c,"i",b,"!","&&","%","==")+"){"},":([\\w-]+)(\\(([^)]+)\\))?":function(a,b,c,d){return"if("+format(Selector.pseudoClasses[b],index,d||"")+"){"},"\\[([\\w-]+)\\s*([^=]?=)?\\s*([^\\]]*)\\]":function(a,b,c,d){if(c){if(b=="class")b=="className";else if(b=="for")b=="htmlFor";b=format("(e%1.getAttribute('%2')||e%1['%2'])",index,b)}else{b=format("Element.getAttribute(e%1,'%2')",index,b)}var e=Selector.operators[c||""];if(instanceOf(e,RegExp)){reg.push(new RegExp(format(e.source,rescape(parser.unescape(d)))));e="reg[%2].test(%1)";d=reg.length-1}return"if("+format(e,b,d)+"){"}});Selector.parse=function(f){if(!cache[f]){reg=[];fn="";var g=parser.escape(f).split(",");forEach(g,function(a,b){index=list=dup=0;var c=parser.exec(a);if(wild&&MSIE){c+=format("if(e%1.tagName!='!'){",index)}var d=(b||dup>1)?TEST:"";c+=format(d+STORE,index);var e=match(c,/\{/g).length;while(e--)c+="}";fn+=c});eval(format(FN,reg)+parser.unescape(fn)+"return s?null:r}");cache[f]=fn}return cache[f]}};AbstractView.implement(ViewCSS);Document.implement(DocumentSelector);Document.implement(DocumentEvent);Document.implement(EventTarget);Element.implement(ElementSelector);Element.implement(EventTarget);var HTMLDocument=Document.extend({"@!(document.nodeType)":{nodeType:9},"@!(document.getElementsByClassName)":{getElementsByClassName:function(a,b){return this.matchAll(a,"."+b.join("."))}}},{"@(document.activeElement===undefined)":{bind:function(b){this.base(b);b.activeElement=null;b.addEventListener("focus",function(a){b.activeElement=a.target},false);return b}}});var HTMLElement=Element.extend({addClass:function(a,b){if(!this.hasClass(a,b)){a.className+=(a.className?" ":"")+b;return b}},hasClass:function(a,b){var c=new RegExp("(^|\\s)"+b+"(\\s|$)");return c.test(a.className)},removeClass:function(a,b){var c=new RegExp("(^|\\s)"+b+"(\\s|$)");a.className=a.className.replace(c,"$2");return b},"@!(element.getElementsByClassName)":{getElementsByClassName:function(a,b){return this.matchAll(a,"."+b.join("."))}}},{bindings:{},tags:"*",extend:function(){var b=base(this,arguments);var c=(b.tags||"").toUpperCase().split(",");forEach(c,function(a){HTMLElement.bindings[a]=b});return b},"@!(element.ownerDocument)":{bind:function(a){this.base(a);a.ownerDocument=Traversal.getOwnerDocument(a);return a}}});extend(DOM,"bind",function(a){if(typeof a.className=="string"){(HTMLElement.bindings[a.tagName]||HTMLElement).bind(a)}else if(a.body!==undefined){HTMLDocument.bind(a)}else{this.base(a)}return a});eval(this.exports)};new function(_){var JSB=new base2.Namespace(this,{name:"JSB",version:"0.6",imports:"DOM",exports:"Binding,Rule,RuleList"});eval(this.imports);var Call=function(a,b,c,d){this.call=function(){b.apply(a,c)};this.rank=d||100};var System=new Base({ready:false,_deferred:new Array2,defer:function(a,b){var c=function(){if(System._deferred){System._deferred.push(new Call(this,a,arguments,b))}else{a.apply(this,arguments)}};return c},onload:function(){if(!System.ready){System.ready=true;DOM.bind(document);System._deferred.sort(function(a,b){return a.rank-b.rank});System._deferred.invoke("call");delete System._deferred;setTimeout(function(){EventTarget.dispatchEvent(document,"ready")},0)}}});EventTarget.addEventListener(document,"DOMContentLoaded",System.onload);extend(Event,{PATTERN:/^on(DOMContentLoaded|[a-z]+)$/,cancel:function(a){a.stopPropagation();a.preventDefault();return false}});extend(HTMLElement.prototype,"extend",function(a,b){if(!Base._prototyping&&Event.PATTERN.test(a)&&typeof b=="function"){EventTarget.addEventListener(this,a.slice(2),b);return this}if(arguments.length==2&&a=="style"){extend(this.style,b);return this}return base(this,arguments)});extend(EventTarget,{addEventListener:function(a,b,c,d){if(b.indexOf("document")==0){b=b.slice(8);d=a;a=Traversal.getOwnerDocument(a)}this.base(a,b,c,d)},removeEventListener:function(a,b,c){if(b.indexOf("document")==0){b=b.slice(8);a=Traversal.getOwnerDocument(a)}this.base(a,b,c)}});var Binding=Abstract.extend();var Rule=Base.extend({constructor:function(c,d){this.selector=instanceOf(c,Selector)?c:new Selector(c);if(typeof d!="function"){d=Binding.extend(d)}this.binding=d;var e={};this.bind=function(a){var b=assignID(a);if(!e[b]){e[b]=true;d(DOM.bind(a))}};this.apply()},binding:null,selector:null,apply:System.defer(function(){forEach(this.selector.exec(document),this.bind)}),bind:function(a){},refresh:function(){this.apply()},toString:function(){return String(this.selector)}});var RuleList=Collection.extend({constructor:function(a){this.base(a);this.globalize()},globalize:System.defer(function(){var e=/\s*,\s*/;var f=/^#[\w-]+$/;forEach(this,function(c,d){forEach(d.split(e),function(a){if(f.test(a)){var b=ViewCSS.toCamelCase(a.slice(1));window[b]=Document.matchSingle(document,a)}})})},10),refresh:function(){this.invoke("refresh")}},{Item:Rule});eval(this.exports)};new function(_){eval(base2.namespace);var DEFAULT="@0";var IGNORE=RegGrp.IGNORE;Colorizer=RegGrp.extend({constructor:function(a,b,c){this.patterns=b||{};this.extend(c);this.base(a)},patterns:null,tabStop:4,urls:true,copy:function(){var a=this.base();a.patterns=copy(this.patterns);return a},exec:function(a){a=this.base(this.escape(a));if(!arguments[1]){a=this._parseWhiteSpace(a);if(this.urls)a=Colorizer.urls.exec(a)}return this.unescape(a)},escape:function(a){return String(a).replace(/</g,"\x01").replace(/&/g,"\x02")},store:function(c,d){if(!instanceOf(c,RegGrp.Item)){if(typeof d=="string"){d=d.replace(/@(\d)/,function(a,b){return format(Colorizer.$FORMAT,c,b)})}c=this.patterns[c]||Colorizer.patterns[c]||c;if(instanceOf(c,RegExp))c=c.source;c=this.escape(c)}this.base(c,d)},unescape:function(a){return a.replace(/\x01/g,"&lt;").replace(/\x02/g,"&amp;")},_parseWhiteSpace:function(c){var d=this.tabStop;if(d>0){var e=Array(d+1).join(" ");return c.replace(Colorizer.TABS,function(a){a=a.replace(Colorizer.TAB,e);if(d>1){var b=(a.length-1)%d;if(b)a=a.slice(0,-b)}return a.replace(/ /g,"&nbsp;")})}},"@MSIE":{_parseWhiteSpace:function(a){return this.base(a).replace(/\r?\n/g,"<br>")}}},{$FORMAT:'<span class="%1">$%2</span>',DEFAULT:DEFAULT,IGNORE:IGNORE,TAB:/\t/g,TABS:/\n([\t \xa0]+)/g,init:function(){forEach(this.patterns,function(c,d,e){if(instanceOf(c,Array)){e[d]=reduce(c,function(a,b){a.add(e[b]);return a},new RegGrp)}});this.urls=this.patterns.urls.copy();this.urls.storeAt(0,'<a href="mailto:$0">$0</a>');this.urls.storeAt(1,'<a href="$0">$0</a>')},patterns:{block_comment:/\/\*[^*]*\*+([^\/][^*]*\*+)*\//,email:/([\w.+-]+@[\w.-]+\.\w+)/,line_comment:/\/\/[^\r\n]*/,number:/\b[+-]?(\d*\.?\d+|\d+\.?\d*)([eE][+-]?\d+)?\b/,string1:/'(\\.|[^'\\])*'/,string2:/"(\\.|[^"\\])*"/,url:/(http:\/\/+[\w\/\-%&#=.,?+$]+)/,comment:["block_comment","line_comment"],string:["string1","string2"],urls:["email","url"]},urls:null,"@KHTML":{$FORMAT:'<span class="%1">$$%2</span>'}});Colorizer.xml=new Colorizer({comment:DEFAULT,cdata:IGNORE,pi:DEFAULT,tag:"$1@2",attribute:'@1=<span class="attribute value">$2</span>',entity:DEFAULT,text:IGNORE},{attribute:/(\w+)=("[^"]*"|'[^']*')/,cdata:/<!\[CDATA\[([^\]]|\][^\]]|\]\][^>])*\]\]>/,comment:/<!\s*(--([^-]|[\r\n]|-[^-])*--\s*)>/,entity:/&#?\w+;/,pi:/<\?[\w-]+[^>]+>/,tag:/(<\/?)([\w:-]+)/,text:/[>;][^<>&]*/},{tabStop:1});Colorizer.html=new Colorizer({conditional:DEFAULT,doctype:DEFAULT,inline:function(a,b,c,d){return Colorizer.html.processCDATA(b,c,d)}},{conditional:/<!(--)?\[[^\]]*\]>|<!\[endif\](--)?>/,doctype:/<!DOCTYPE[^>]+>/,inline:/<(script|style)([^>]*)>((\\.|[^\\])*)<\/\1>/},{tabStop:1,CDATA:'&lt;<span class="tag">%1</span>%2&gt;%3&lt;/<span class="tag">%1</span>&gt;',processCDATA:function(a,b,c){return format(this.CDATA,a,this.exec(b,true),c)}});Colorizer.html.merge(Colorizer.xml);Colorizer.css=new Colorizer({comment:DEFAULT,at_rule:DEFAULT,bracketed:IGNORE,selector:"@1{",special:"@1:",property:'@1:<span class="property value">$2</span>'},{at_rule:/@[\w\s]+/,bracketed:/\([^'\x22)]*\)/,comment:Colorizer.patterns.block_comment,property:/(\w[\w-]*\s*):([^;}]+)/,special:/(\-[\w-]*\s*):/,selector:/([\w-:\[.#][^{};]*)\{/});Colorizer.javascript=new Colorizer({string:DEFAULT,conditional:DEFAULT,comment:DEFAULT,regexp:"$1@2",number:DEFAULT,special:DEFAULT,global:DEFAULT,keyword:DEFAULT},{conditional:/\/\*@if\s*\([^\)]*\)|\/\*@[\s\w]*|@\*\/|\/\/@\w+|@else[\s\w]*/,global:/\b(clearInterval|clearTimeout|constructor|document|escape|hasOwnProperty|Infinity|isNaN|NaN|parseFloat|parseInt|prototype|setInterval|setTimeout|toString|unescape|valueOf|window)\b/,keyword:/\b(&&|\|\||arguments|break|case|continue|default|delete|do|else|false|for|function|if|in|instanceof|new|null|return|switch|this|true|typeof|var|void|while|with|undefined)\b/,regexp:/([\[(\^=,{}:;&|!*?]\s*)(\/(\\\/|[^\/*])(\\.|[^\/\n\\])*\/[mgi]*)/,special:/\b(alert|catch|confirm|eval|finally|prompt|throw|try)\b/});Colorizer["html-multi"]=Colorizer.html.union({inline:function(a,b,c,d){var e=b=="style"?"css":"javascript";d=Colorizer[e].exec(d,true);d=format('<span class="%1">%2</span>',e,d);return Colorizer.html.processCDATA(b,c,d)}})};eval(base2.namespace);eval(DOM.namespace);eval(JSB.namespace);var ATTRIBUTE=/(\w+)=([^"'\s]+)/g;var QUOTE='<blockquote cite="#%1">\n%3\n<address>'+'<a href="#%1" rel="bookmark">%2</a></address>\n</blockquote>';var TIDY=new RegGrp({"(<\\/?)(\\w+)([^>]*)":function($,c,d,e){return c+d.toLowerCase()+e.replace(ATTRIBUTE,function($,a,b){return a.toLowerCase()+'"'+b+'"'})},"&nbsp;":" "});Colorizer.javascript.store("\\b(assignID|base|base2|base2ID|every|extend|filter|forEach|"+"format|implement|instanceOf|invoke|K|map|pluck|reduce|rescape|slice|some|trim)\\b",'<span class="base2">$0</span>');function updateFlag(){this.nextSibling.style.color=this.value?"#898E79":"#A03333"};new RuleList({"pre":{ondocumentready:function(){var a=this.className.split(/\s+/);for(var i=0;i<a.length;i++){var b=a[i];var c=Colorizer[b];if(instanceOf(c,Colorizer)){var d=Traversal.getTextContent(this);this.setAttribute("originalText",d);this.innerHTML=c.exec(d);this.addClass("highlight");if(b=="html-multi")this.addClass("html");break}}}},"input.required,textarea.required":{ondocumentready:updateFlag,ondocumentmouseup:updateFlag,ondocumentkeyup:updateFlag},"li.comment:not(.disabled)":{ondocumentready:function(){var j=this;var k=document.createElement("button");Traversal.setTextContent(k,"Quote");j.appendChild(k);k.onclick=function(){var b=document.matchSingle("textarea");var c=j.id;var d=j.matchSingle("cite:last-child");var e=Traversal.getTextContent(d)||"comment #"+c;e=e.replace(/(^\s*comment(\s+by)?\s)|(\s\W\s.*$)/gi,"");var f="";if(window.getSelection){f=String(window.getSelection())}else if(document.selection){f=document.selection.createRange().text}if(f){var g="<p>"+trim(f)+"</p>"}else{var h=j.matchSingle("div.comment-text").cloneNode(true);forEach(Element.matchAll(h,"pre"),function(a){Traversal.setTextContent(a,a.getAttribute("originalText"));a.removeAttribute("originalText");a.removeAttribute("style");a.removeAttribute("base2ID")});forEach(Element.matchAll(h,"img"),function(a){a.parentNode.replaceChild(document.createTextNode(a.alt),a)});g=trim(TIDY.exec(h.innerHTML))}var i=format(QUOTE,c,e,g);b.value=trim(b.value+"\n"+i);b.focus()}},onmouseover:function(){this.matchSingle("button").style.visibility="visible"},onmouseout:function(){this.matchSingle("button").style.visibility=""}}});
